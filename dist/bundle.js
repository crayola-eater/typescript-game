(()=>{"use strict";class t{constructor(t,e,s,i){this.x=t,this.y=e,this.width=s,this.height=i}collidesWith(t){return this.topLeft.x<t.bottomRight.x&&this.bottomRight.x>t.topLeft.x&&this.topLeft.y<t.bottomRight.y&&this.bottomRight.y>t.topRight.y}collidesWithAny(...t){return t.some((t=>this.collidesWith(t)))}extendsBeyond(t){return this.topLeft.x<t.topLeft.x||this.bottomRight.x>t.bottomRight.x||this.topLeft.y<t.topLeft.y||this.bottomRight.y>t.bottomRight.y}getAllCollisionsWith(...t){return t.filter((t=>this.collidesWith(t)))}get topLeft(){return{x:this.x,y:this.y}}get topRight(){return{x:this.x+this.width,y:this.y}}get bottomLeft(){return{x:this.x,y:this.y+this.height}}get bottomRight(){return{x:this.x+this.width,y:this.y+this.height}}get center(){return{x:this.x+this.width/2,y:this.y+this.height/2}}}class e extends t{constructor(t,e,s,i,h=0,o=0,n=5){super(t,e,s,i),this.deltaX=h,this.deltaY=o,this.movementAmount=n}moveBy(t,e){this.x+=t,this.y+=e}move(){this.x+=this.deltaX,this.y+=this.deltaY}moveBack(){this.moveBy(-this.deltaX,-this.deltaY)}}class s extends e{constructor(t,e,s,i,h,o=100,n=100,r=0,a=0){super(e,s,o,n,r,a),this.details=t,this.health=i,this.shooter=h}shoot(t){this.shooter.shoot({x:this.center.x,y:this.center.y},{x:t.x,y:t.y})}draw(t){t.fillStyle=this.details.colour,t.fillRect(this.x,this.y,this.width,this.height),t.fillStyle=this.health.currentColour,t.fillRect(this.x,this.y-40,this.health.currentPercentage*this.width,20),t.strokeStyle="black",t.lineWidth=2,t.strokeRect(this.x,this.y-40,this.width,20),t.fillStyle="black",t.fillText(this.details.name,this.x,this.y-50)}}var i,h=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)};class o extends s{constructor(t,e,s,h,o,n=100,r=100){super(t,e,s,h,o,n,r),this.details=t,this.health=h,this.shooter=o,i.set(this,void 0);const a=(new Date).getTime();!function(t,e,s){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");e.set(t,s)}(this,i,{changedDeltaX:a,changedDeltaY:a,shot:a})}get shouldChangeDirection(){return(new Date).getTime()>h(this,i).changedDeltaX+100}get shouldShoot(){return(new Date).getTime()>h(this,i).shot+500}maybeChangeDirection(){if(this.shouldChangeDirection){const t=Math.random()<.5?-1:1;this.deltaX=5*Math.random()*t;const e=Math.random()<.5?-1:1;this.deltaY=5*Math.random()*e;const s=(new Date).getTime();h(this,i).changedDeltaX=s,h(this,i).changedDeltaY=s}}move(){this.maybeChangeDirection(),super.move()}shoot(t){this.shouldShoot&&(h(this,i).shot=(new Date).getTime(),super.shoot(t))}}i=new WeakMap;class n extends t{constructor(t,e,s,i,h){super(t,e,s,i),this.health=h}draw(t){t.fillStyle="#704300",t.fillRect(this.x,this.y,this.width,this.height),t.fillStyle=this.health.currentColour,t.fillRect(this.x,this.y-40,this.health.currentPercentage*this.width,20),t.strokeStyle="black",t.lineWidth=2,t.strokeRect(this.x,this.y-40,this.width,20)}}class r{constructor(t,e=t){this.maxHealth=t,this.currentHealth=e}changeHealthBy(t){this.currentHealth=Math.max(0,this.currentHealth+t)}get isEmpty(){return 0===this.currentHealth}get currentPercentage(){return this.currentHealth/this.maxHealth}get currentColour(){return this.currentPercentage>.6?"green":this.currentPercentage>.4?"yellow":"red"}}class a extends e{constructor(t,e,s=5,i=5,h=15,o=10){super(t.x,t.y,s,i,0,0),this.speed=h,this.damage=o;const n={deltaX:e.x-t.x,deltaY:e.y-t.y},r=Math.atan2(n.deltaY,n.deltaX);this.deltaX=Math.cos(r)*h,this.deltaY=Math.sin(r)*h}draw(t){t.fillStyle="goldenrod",t.fillRect(this.x,this.y,7,7)}}class l{constructor(){this.shotsFired=[]}shoot(t,e){const s=new a(t,e);this.shotsFired.push(s)}remove(t){this.shotsFired=this.shotsFired.filter((e=>e!==t))}removeShots(...t){this.shotsFired=this.shotsFired.filter((e=>!t.includes(e)))}keepShotsWhere(t){this.shotsFired=this.shotsFired.filter(t)}}var c,d=function(t,e,s){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,s),s},u=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)};c=new WeakMap;const y=new o({name:"big_guy1954 (🖥️)",colour:"purple"},300,300,new r(400),new l),p=new o({name:"strangeOne45 (🖥️)",colour:"red"},300,50,new r(50),new l,20,20),m=new o({name:"0101010101 (🖥️)",colour:"navy"},400,200,new r(100),new l),w={players:[new class extends s{constructor(t,e,s,i,h,o,n=100,r=100,a=0,l=0){super(t,e,s,i,o,n,r,a,l),this.details=t,this.health=i,this.controls=h,this.shooter=o,this.controls.onInputHandler=(t,e,s)=>{"LMB"===t&&e&&super.shoot({x:s.x,y:s.y})},this.movementAmount=5}move(){this.controls.inputs.KeyW?this.deltaY=-this.movementAmount:this.controls.inputs.KeyS?this.deltaY=this.movementAmount:this.deltaY=0,this.controls.inputs.KeyA?this.deltaX=-this.movementAmount:this.controls.inputs.KeyD?this.deltaX=this.movementAmount:this.deltaX=0,super.move()}}({name:"You (🎮)",colour:"olive"},0,400,new r(200),new class{constructor(t,e){c.set(this,void 0),this.inputs={KeyW:!1,KeyA:!1,KeyS:!1,KeyD:!1,LMB:!1},d(this,c,((t,e)=>console.log({input:t,newValue:e})));const s=t=>{0===t.button&&(this.inputs.LMB="mousedown"===t.type,u(this,c).call(this,"LMB",this.inputs.LMB,t))},i=t=>{const{code:e}=t;this.inputs.hasOwnProperty(e)&&(this.inputs[e]="keydown"===t.type,u(this,c).call(this,e,this.inputs[e],t))};t.addEventListener("mouseup",s),t.addEventListener("mousedown",s),e.addEventListener("keyup",i),e.addEventListener("keydown",i)}set onInputHandler(t){d(this,c,t)}}(document.querySelector("canvas"),window),new l),y,p,m],obstacles:[new n(200,200,50,50,new r(300)),new n(100,300,20,150,new r(300)),new n(600,400,90,70,new r(300))],world:new class extends t{constructor(t,e){super(0,0,t,e)}draw(){}}(700,500)};var g,f=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)};g=new WeakMap;const{world:x,players:v,obstacles:b}=w,W=document.querySelector("canvas");new class{constructor(t,e,s,i){this.world=t,this.players=e,this.obstacles=s,this.canvas=i,g.set(this,void 0),this.canvas.height=this.world.height,this.canvas.width=this.world.width,function(t,e,s){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");e.set(t,s)}(this,g,this.canvas.getContext("2d"))}get computerPlayers(){return this.players.filter((t=>t instanceof o))}otherPlayers(t){return this.players.filter((e=>e!==t))}updatePositions(){for(const t of this.computerPlayers){const e=this.players.find((e=>e!==t));t.shoot({x:e.center.x,y:e.center.y})}this.players=this.players.filter((t=>!t.health.isEmpty));for(const t of this.players){t.move(),(t.extendsBeyond(this.world)||t.collidesWithAny(...this.otherPlayers(t))||t.collidesWithAny(...this.obstacles))&&t.moveBack();for(const e of t.shooter.shotsFired)e.move();this.processCollisions()}}processCollisions(){for(const t of this.players)t.shooter.keepShotsWhere((e=>{const s=e.getAllCollisionsWith(...this.obstacles);s.forEach((t=>t.health.changeHealthBy(-e.damage)));const i=e.getAllCollisionsWith(...this.otherPlayers(t));return i.forEach((t=>t.health.changeHealthBy(-e.damage))),0===s.length&&0===i.length&&!e.extendsBeyond(this.world)}));this.obstacles=this.obstacles.filter((t=>!t.health.isEmpty))}draw(){f(this,g).clearRect(0,0,this.canvas.width,this.canvas.height);for(const t of this.players){t.draw(f(this,g));for(const e of t.shooter.shotsFired)e.draw(f(this,g));for(const t of this.obstacles)t.draw(f(this,g))}}getWinnerOrNull(){const t=this.players.filter((t=>!t.health.isEmpty));return 1===t.length?t[0]:null}play(){this.updatePositions(),this.draw();const t=this.getWinnerOrNull();t?setTimeout((()=>alert(t.details.name+" won!")),10):requestAnimationFrame(this.play.bind(this))}}(x,v,b,W).play()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zbWFsbC1nYW1lLy4vc3JjL21vZGVsL2NvbXBvbmVudHMvc2hhcGUudHMiLCJ3ZWJwYWNrOi8vc21hbGwtZ2FtZS8uL3NyYy9tb2RlbC9jb21wb25lbnRzL21vdmFibGVTaGFwZS50cyIsIndlYnBhY2s6Ly9zbWFsbC1nYW1lLy4vc3JjL21vZGVsL2NvbXBvbmVudHMvcGxheWVyLnRzIiwid2VicGFjazovL3NtYWxsLWdhbWUvLi9zcmMvbW9kZWwvY2xhc3Nlcy9jb21wdXRlclBsYXllci50cyIsIndlYnBhY2s6Ly9zbWFsbC1nYW1lLy4vc3JjL21vZGVsL2NsYXNzZXMvb2JzdGFjbGUudHMiLCJ3ZWJwYWNrOi8vc21hbGwtZ2FtZS8uL3NyYy9tb2RlbC9jb21wb25lbnRzL2hlYWx0aC50cyIsIndlYnBhY2s6Ly9zbWFsbC1nYW1lLy4vc3JjL21vZGVsL2NvbXBvbmVudHMvc2hvdC50cyIsIndlYnBhY2s6Ly9zbWFsbC1nYW1lLy4vc3JjL21vZGVsL2NvbXBvbmVudHMvc2hvb3Rlci50cyIsIndlYnBhY2s6Ly9zbWFsbC1nYW1lLy4vc3JjL2RlZmF1bHRHYW1lLnRzIiwid2VicGFjazovL3NtYWxsLWdhbWUvLi9zcmMvbW9kZWwvY2xhc3Nlcy9odW1hblBsYXllci50cyIsIndlYnBhY2s6Ly9zbWFsbC1nYW1lLy4vc3JjL21vZGVsL2NvbXBvbmVudHMvY29udHJvbHMudHMiLCJ3ZWJwYWNrOi8vc21hbGwtZ2FtZS8uL3NyYy9tb2RlbC9jbGFzc2VzL3dvcmxkLnRzIiwid2VicGFjazovL3NtYWxsLWdhbWUvLi9zcmMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vc21hbGwtZ2FtZS8uL3NyYy9tb2RlbC9jbGFzc2VzL2dhbWUudHMiXSwibmFtZXMiOlsiU2hhcGUiLCJ4IiwieSIsIndpZHRoIiwiaGVpZ2h0Iiwib3RoZXJTaGFwZSIsInRoaXMiLCJ0b3BMZWZ0IiwiYm90dG9tUmlnaHQiLCJ0b3BSaWdodCIsIm90aGVyU2hhcGVzIiwic29tZSIsImNvbGxpZGVzV2l0aCIsImZpbHRlciIsIk1vdmFibGVTaGFwZSIsImRlbHRhWCIsImRlbHRhWSIsIm1vdmVtZW50QW1vdW50Iiwic3VwZXIiLCJtb3ZlQnkiLCJQbGF5ZXIiLCJkZXRhaWxzIiwiaGVhbHRoIiwic2hvb3RlciIsImF0Iiwic2hvb3QiLCJjZW50ZXIiLCJjdHgiLCJmaWxsU3R5bGUiLCJjb2xvdXIiLCJmaWxsUmVjdCIsImN1cnJlbnRDb2xvdXIiLCJjdXJyZW50UGVyY2VudGFnZSIsInN0cm9rZVN0eWxlIiwibGluZVdpZHRoIiwic3Ryb2tlUmVjdCIsImZpbGxUZXh0IiwibmFtZSIsIkNvbXB1dGVyUGxheWVyIiwiY3VycmVudFRpbWUiLCJEYXRlIiwiZ2V0VGltZSIsImNoYW5nZWREZWx0YVgiLCJjaGFuZ2VkRGVsdGFZIiwic2hvdCIsInNob3VsZENoYW5nZURpcmVjdGlvbiIsImxlZnRPclJpZ2h0IiwiTWF0aCIsInJhbmRvbSIsInVwT3JEb3duIiwibWF5YmVDaGFuZ2VEaXJlY3Rpb24iLCJtb3ZlIiwic2hvdWxkU2hvb3QiLCJPYnN0YWNsZSIsIkhlYWx0aCIsIm1heEhlYWx0aCIsImN1cnJlbnRIZWFsdGgiLCJjaGFuZ2UiLCJtYXgiLCJTaG90IiwiZnJvbSIsInRvIiwic3BlZWQiLCJkYW1hZ2UiLCJvcmlnaW5hbERlbHRhIiwicmFkaWFucyIsImF0YW4yIiwiY29zIiwic2luIiwiU2hvb3RlciIsInNob3RzRmlyZWQiLCJwdXNoIiwic2hvdFRvUmVtb3ZlIiwic2hvdHNUb1JlbW92ZSIsImluY2x1ZGVzIiwicHJlZGljYXRlIiwiYmlnR3V5Iiwic3RyYW5nZU9uZSIsIm1haW5Db21wdXRlciIsImRlZmF1bHRDb25maWciLCJwbGF5ZXJzIiwiY29udHJvbHMiLCJvbklucHV0SGFuZGxlciIsImlucHV0IiwibmV3U3RhdGUiLCJldmVudCIsImlucHV0cyIsIktleVciLCJLZXlTIiwiS2V5QSIsIktleUQiLCJjYW52YXMiLCJ3aW5kb3ciLCJMTUIiLCJuZXdWYWx1ZSIsImNvbnNvbGUiLCJsb2ciLCJjbGlja0xpc3RlbmVyIiwiZSIsImJ1dHRvbiIsInR5cGUiLCJrZXlMaXN0ZW5lciIsImNvZGUiLCJoYXNPd25Qcm9wZXJ0eSIsImFkZEV2ZW50TGlzdGVuZXIiLCJuZXdIYW5kbGVyIiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwib2JzdGFjbGVzIiwid29ybGQiLCJnZXRDb250ZXh0IiwicGxheWVyIiwicGxheWVyVG9FeGNsdWRlIiwiY29tcHV0ZXJQbGF5ZXIiLCJjb21wdXRlclBsYXllcnMiLCJwbGF5ZXJUb1Nob290IiwiZmluZCIsImlzRW1wdHkiLCJleHRlbmRzQmV5b25kIiwiY29sbGlkZXNXaXRoQW55Iiwib3RoZXJQbGF5ZXJzIiwibW92ZUJhY2siLCJwcm9jZXNzQ29sbGlzaW9ucyIsImtlZXBTaG90c1doZXJlIiwib2JzdGFjbGVzU2hvdCIsImdldEFsbENvbGxpc2lvbnNXaXRoIiwiZm9yRWFjaCIsIm9ic3RhY2xlIiwiY2hhbmdlSGVhbHRoQnkiLCJwbGF5ZXJzU2hvdCIsImxlbmd0aCIsImNsZWFyUmVjdCIsImRyYXciLCJyZW1haW5pbmdQbGF5ZXJzIiwidXBkYXRlUG9zaXRpb25zIiwid2lubmVyT3JOdWxsIiwiZ2V0V2lubmVyT3JOdWxsIiwic2V0VGltZW91dCIsImFsZXJ0IiwicmVxdWVzdEFuaW1hdGlvbkZyYW1lIiwicGxheSIsImJpbmQiXSwibWFwcGluZ3MiOiJtQkFFTyxNQUFlQSxFQUNwQixZQUNTQyxFQUNBQyxFQUNBQyxFQUNBQyxHQUhBLEtBQUFILElBQ0EsS0FBQUMsSUFDQSxLQUFBQyxRQUNBLEtBQUFDLFNBR1QsYUFBYUMsR0FDWCxPQUNFQyxLQUFLQyxRQUFRTixFQUFJSSxFQUFXRyxZQUFZUCxHQUN4Q0ssS0FBS0UsWUFBWVAsRUFBSUksRUFBV0UsUUFBUU4sR0FDeENLLEtBQUtDLFFBQVFMLEVBQUlHLEVBQVdHLFlBQVlOLEdBQ3hDSSxLQUFLRSxZQUFZTixFQUFJRyxFQUFXSSxTQUFTUCxFQUk3QyxtQkFBbUJRLEdBQ2pC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LENBQ2pDK0IsRUFBT3FCLEtBQUssRUFBQTlILEtBQUEsSUFFWixJQUFLLE1BQU1zQyxLQUFRbUUsRUFBT3hGLFFBQVErQyxXQUNoQzFCLEVBQUt3RixLQUFLLEVBQUE5SCxLQUFBLElBR1osSUFBSyxNQUFNeUgsS0FBWXpILEtBQUtzRyxVQUMxQm1CLEVBQVNLLEtBQUssRUFBQTlILEtBQUEsS0FLcEIsa0JBQ0UsTUFBTStILEVBQW1CL0gsS0FBSzBFLFFBQVFuRSxRQUNuQ2tHLElBQVlBLEVBQU96RixPQUFPK0YsVUFHN0IsT0FBbUMsSUFBNUJnQixFQUFpQkgsT0FBZUcsRUFBaUIsR0FBSyxLQUcvRCxPQUNFL0gsS0FBS2dJLGtCQUNMaEksS0FBSzhILE9BQ0wsTUFBTUcsRUFBZWpJLEtBQUtrSSxrQkFDdEJELEVBQ0ZFLFlBQVcsSUFBTUMsTUFBU0gsRUFBYWxILFFBQVFnQixLQUF4QixVQUFzQyxJQUkvRHNHLHNCQUFzQnJJLEtBQUtzSSxLQUFLQyxLQUFLdkksU0R6SG5CLEVBQU8sRUFBUyxFQUFXcUYsR0FDNUNpRCxRIiwiZmlsZSI6ImJ1bmRsZS5qcyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBvc2l0aW9uRGV0YWlscyB9IGZyb20gXCIuLi9pbnRlcmZhY2VzL3Bvc2l0aW9uRGV0YWlsc1wiO1xyXG5cclxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIFNoYXBlIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHB1YmxpYyB4OiBudW1iZXIsXHJcbiAgICBwdWJsaWMgeTogbnVtYmVyLFxyXG4gICAgcHVibGljIHdpZHRoOiBudW1iZXIsXHJcbiAgICBwdWJsaWMgaGVpZ2h0OiBudW1iZXJcclxuICApIHt9XHJcblxyXG4gIGNvbGxpZGVzV2l0aChvdGhlclNoYXBlOiBTaGFwZSk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIChcclxuICAgICAgdGhpcy50b3BMZWZ0LnggPCBvdGhlclNoYXBlLmJvdHRvbVJpZ2h0LnggJiZcclxuICAgICAgdGhpcy5ib3R0b21SaWdodC54ID4gb3RoZXJTaGFwZS50b3BMZWZ0LnggJiZcclxuICAgICAgdGhpcy50b3BMZWZ0LnkgPCBvdGhlclNoYXBlLmJvdHRvbVJpZ2h0LnkgJiZcclxuICAgICAgdGhpcy5ib3R0b21SaWdodC55ID4gb3RoZXJTaGFwZS50b3BSaWdodC55XHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgY29sbGlkZXNXaXRoQW55KC4uLm90aGVyU2hhcGVzOiBTaGFwZVtdKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gb3RoZXJTaGFwZXMuc29tZSgob3RoZXJTaGFwZSkgPT4gdGhpcy5jb2xsaWRlc1dpdGgob3RoZXJTaGFwZSkpO1xyXG4gIH1cclxuXHJcbiAgZXh0ZW5kc0JleW9uZChvdGhlclNoYXBlOiBTaGFwZSk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIChcclxuICAgICAgdGhpcy50b3BMZWZ0LnggPCBvdGhlclNoYXBlLnRvcExlZnQueCB8fFxyXG4gICAgICB0aGlzLmJvdHRvbVJpZ2h0LnggPiBvdGhlclNoYXBlLmJvdHRvbVJpZ2h0LnggfHxcclxuICAgICAgdGhpcy50b3BMZWZ0LnkgPCBvdGhlclNoYXBlLnRvcExlZnQueSB8fFxyXG4gICAgICB0aGlzLmJvdHRvbVJpZ2h0LnkgPiBvdGhlclNoYXBlLmJvdHRvbVJpZ2h0LnlcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBnZXRBbGxDb2xsaXNpb25zV2l0aDxUIGV4dGVuZHMgU2hhcGU+KC4uLm90aGVyU2hhcGVzOiBUW10pOiBUW10ge1xyXG4gICAgcmV0dXJuIG90aGVyU2hhcGVzLmZpbHRlcigob3RoZXJTaGFwZSkgPT4gdGhpcy5jb2xsaWRlc1dpdGgob3RoZXJTaGFwZSkpO1xyXG4gIH1cclxuXHJcbiAgYWJzdHJhY3QgZHJhdyhjdHg6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCk6IHZvaWQ7XHJcblxyXG4gIGdldCB0b3BMZWZ0KCk6IFBvc2l0aW9uRGV0YWlscyB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICB4OiB0aGlzLngsXHJcbiAgICAgIHk6IHRoaXMueSxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBnZXQgdG9wUmlnaHQoKTogUG9zaXRpb25EZXRhaWxzIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHg6IHRoaXMueCArIHRoaXMud2lkdGgsXHJcbiAgICAgIHk6IHRoaXMueSxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBnZXQgYm90dG9tTGVmdCgpOiBQb3NpdGlvbkRldGFpbHMge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgeDogdGhpcy54LFxyXG4gICAgICB5OiB0aGlzLnkgKyB0aGlzLmhlaWdodCxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBnZXQgYm90dG9tUmlnaHQoKTogUG9zaXRpb25EZXRhaWxzIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHg6IHRoaXMueCArIHRoaXMud2lkdGgsXHJcbiAgICAgIHk6IHRoaXMueSArIHRoaXMuaGVpZ2h0LFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIGdldCBjZW50ZXIoKTogUG9zaXRpb25EZXRhaWxzIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHg6IHRoaXMueCArIHRoaXMud2lkdGggLyAyLFxyXG4gICAgICB5OiB0aGlzLnkgKyB0aGlzLmhlaWdodCAvIDIsXHJcbiAgICB9O1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBTaGFwZSB9IGZyb20gXCIuL3NoYXBlXCI7XHJcblxyXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgTW92YWJsZVNoYXBlIGV4dGVuZHMgU2hhcGUge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgeDogbnVtYmVyLFxyXG4gICAgeTogbnVtYmVyLFxyXG4gICAgd2lkdGg6IG51bWJlcixcclxuICAgIGhlaWdodDogbnVtYmVyLFxyXG4gICAgcHVibGljIGRlbHRhWDogbnVtYmVyID0gMCxcclxuICAgIHB1YmxpYyBkZWx0YVk6IG51bWJlciA9IDAsXHJcbiAgICBwdWJsaWMgbW92ZW1lbnRBbW91bnQ6IG51bWJlciA9IDVcclxuICApIHtcclxuICAgIHN1cGVyKHgsIHksIHdpZHRoLCBoZWlnaHQpO1xyXG4gIH1cclxuXHJcbiAgbW92ZUJ5KGRlbHRhWDogbnVtYmVyLCBkZWx0YVk6IG51bWJlcik6IHZvaWQge1xyXG4gICAgdGhpcy54ICs9IGRlbHRhWDtcclxuICAgIHRoaXMueSArPSBkZWx0YVk7XHJcbiAgfVxyXG5cclxuICBtb3ZlKCk6IHZvaWQge1xyXG4gICAgdGhpcy54ICs9IHRoaXMuZGVsdGFYO1xyXG4gICAgdGhpcy55ICs9IHRoaXMuZGVsdGFZO1xyXG4gIH1cclxuXHJcbiAgbW92ZUJhY2soKTogdm9pZCB7XHJcbiAgICB0aGlzLm1vdmVCeSgtdGhpcy5kZWx0YVgsIC10aGlzLmRlbHRhWSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IFBsYXllckRldGFpbHMgfSBmcm9tIFwiLi4vaW50ZXJmYWNlcy9wbGF5ZXJEZXRhaWxzXCI7XHJcbmltcG9ydCB7IFBvc2l0aW9uRGV0YWlscyB9IGZyb20gXCIuLi9pbnRlcmZhY2VzL3Bvc2l0aW9uRGV0YWlsc1wiO1xyXG5pbXBvcnQgeyBIZWFsdGggfSBmcm9tIFwiLi9oZWFsdGhcIjtcclxuaW1wb3J0IHsgTW92YWJsZVNoYXBlIH0gZnJvbSBcIi4vbW92YWJsZVNoYXBlXCI7XHJcbmltcG9ydCB7IFNob290ZXIgfSBmcm9tIFwiLi9zaG9vdGVyXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgUGxheWVyIGV4dGVuZHMgTW92YWJsZVNoYXBlIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHB1YmxpYyBkZXRhaWxzOiBQbGF5ZXJEZXRhaWxzLFxyXG4gICAgeDogbnVtYmVyLFxyXG4gICAgeTogbnVtYmVyLFxyXG4gICAgcHVibGljIGhlYWx0aDogSGVhbHRoLFxyXG4gICAgcHVibGljIHNob290ZXI6IFNob290ZXIsXHJcbiAgICB3aWR0aDogbnVtYmVyID0gMTAwLFxyXG4gICAgaGVpZ2h0OiBudW1iZXIgPSAxMDAsXHJcbiAgICBkZWx0YVg6IG51bWJlciA9IDAsXHJcbiAgICBkZWx0YVk6IG51bWJlciA9IDBcclxuICApIHtcclxuICAgIHN1cGVyKHgsIHksIHdpZHRoLCBoZWlnaHQsIGRlbHRhWCwgZGVsdGFZKTtcclxuICB9XHJcblxyXG4gIHNob290KGF0OiBQb3NpdGlvbkRldGFpbHMpOiB2b2lkIHtcclxuICAgIHRoaXMuc2hvb3Rlci5zaG9vdChcclxuICAgICAge1xyXG4gICAgICAgIHg6IHRoaXMuY2VudGVyLngsXHJcbiAgICAgICAgeTogdGhpcy5jZW50ZXIueSxcclxuICAgICAgfSxcclxuICAgICAge1xyXG4gICAgICAgIHg6IGF0LngsXHJcbiAgICAgICAgeTogYXQueSxcclxuICAgICAgfVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIGRyYXcoY3R4OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQpOiB2b2lkIHtcclxuICAgIC8vIFBsYXllciBzcHJpdGVcclxuICAgIGN0eC5maWxsU3R5bGUgPSB0aGlzLmRldGFpbHMuY29sb3VyO1xyXG4gICAgY3R4LmZpbGxSZWN0KHRoaXMueCwgdGhpcy55LCB0aGlzLndpZHRoLCB0aGlzLmhlaWdodCk7XHJcblxyXG4gICAgLy8gUGxheWVyIEhQIGJhclxyXG4gICAgY3R4LmZpbGxTdHlsZSA9IHRoaXMuaGVhbHRoLmN1cnJlbnRDb2xvdXI7XHJcbiAgICBjdHguZmlsbFJlY3QoXHJcbiAgICAgIHRoaXMueCxcclxuICAgICAgdGhpcy55IC0gNDAsXHJcbiAgICAgIHRoaXMuaGVhbHRoLmN1cnJlbnRQZXJjZW50YWdlICogdGhpcy53aWR0aCxcclxuICAgICAgMjBcclxuICAgICk7XHJcbiAgICBjdHguc3Ryb2tlU3R5bGUgPSBcImJsYWNrXCI7XHJcbiAgICBjdHgubGluZVdpZHRoID0gMjtcclxuICAgIGN0eC5zdHJva2VSZWN0KHRoaXMueCwgdGhpcy55IC0gNDAsIHRoaXMud2lkdGgsIDIwKTtcclxuXHJcbiAgICAvLyBQbGF5ZXIgbmFtZVxyXG4gICAgY3R4LmZpbGxTdHlsZSA9IFwiYmxhY2tcIjtcclxuICAgIGN0eC5maWxsVGV4dCh0aGlzLmRldGFpbHMubmFtZSwgdGhpcy54LCB0aGlzLnkgLSA1MCk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IEhlYWx0aCB9IGZyb20gXCIuLi9jb21wb25lbnRzL2hlYWx0aFwiO1xyXG5pbXBvcnQgeyBQbGF5ZXIgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9wbGF5ZXJcIjtcclxuaW1wb3J0IHsgU2hvb3RlciB9IGZyb20gXCIuLi9jb21wb25lbnRzL3Nob290ZXJcIjtcclxuaW1wb3J0IHsgUGxheWVyRGV0YWlscyB9IGZyb20gXCIuLi9pbnRlcmZhY2VzL3BsYXllckRldGFpbHNcIjtcclxuaW1wb3J0IHsgUG9zaXRpb25EZXRhaWxzIH0gZnJvbSBcIi4uL2ludGVyZmFjZXMvcG9zaXRpb25EZXRhaWxzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgQ29tcHV0ZXJQbGF5ZXIgZXh0ZW5kcyBQbGF5ZXIge1xyXG4gICNsYXN0QWN0aW9uczoge1xyXG4gICAgY2hhbmdlZERlbHRhWDogbnVtYmVyO1xyXG4gICAgY2hhbmdlZERlbHRhWTogbnVtYmVyO1xyXG4gICAgc2hvdDogbnVtYmVyO1xyXG4gIH07XHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHVibGljIGRldGFpbHM6IFBsYXllckRldGFpbHMsXHJcbiAgICB4OiBudW1iZXIsXHJcbiAgICB5OiBudW1iZXIsXHJcbiAgICBwdWJsaWMgaGVhbHRoOiBIZWFsdGgsXHJcbiAgICBwdWJsaWMgc2hvb3RlcjogU2hvb3RlcixcclxuICAgIHdpZHRoOiBudW1iZXIgPSAxMDAsXHJcbiAgICBoZWlnaHQ6IG51bWJlciA9IDEwMFxyXG4gICkge1xyXG4gICAgc3VwZXIoZGV0YWlscywgeCwgeSwgaGVhbHRoLCBzaG9vdGVyLCB3aWR0aCwgaGVpZ2h0KTtcclxuXHJcbiAgICBjb25zdCBjdXJyZW50VGltZSA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xyXG4gICAgdGhpcy4jbGFzdEFjdGlvbnMgPSB7XHJcbiAgICAgIGNoYW5nZWREZWx0YVg6IGN1cnJlbnRUaW1lLFxyXG4gICAgICBjaGFuZ2VkRGVsdGFZOiBjdXJyZW50VGltZSxcclxuICAgICAgc2hvdDogY3VycmVudFRpbWUsXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgZ2V0IHNob3VsZENoYW5nZURpcmVjdGlvbigpOiBib29sZWFuIHtcclxuICAgIHJldHVybiBuZXcgRGF0ZSgpLmdldFRpbWUoKSA+IHRoaXMuI2xhc3RBY3Rpb25zLmNoYW5nZWREZWx0YVggKyAxMDA7XHJcbiAgfVxyXG5cclxuICBnZXQgc2hvdWxkU2hvb3QoKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gbmV3IERhdGUoKS5nZXRUaW1lKCkgPiB0aGlzLiNsYXN0QWN0aW9ucy5zaG90ICsgNTAwO1xyXG4gIH1cclxuXHJcbiAgbWF5YmVDaGFuZ2VEaXJlY3Rpb24oKTogdm9pZCB7XHJcbiAgICBpZiAodGhpcy5zaG91bGRDaGFuZ2VEaXJlY3Rpb24pIHtcclxuICAgICAgY29uc3QgbGVmdE9yUmlnaHQgPSBNYXRoLnJhbmRvbSgpIDwgMC41ID8gLTEgOiAxO1xyXG4gICAgICB0aGlzLmRlbHRhWCA9IE1hdGgucmFuZG9tKCkgKiA1ICogbGVmdE9yUmlnaHQ7XHJcblxyXG4gICAgICBjb25zdCB1cE9yRG93biA9IE1hdGgucmFuZG9tKCkgPCAwLjUgPyAtMSA6IDE7XHJcbiAgICAgIHRoaXMuZGVsdGFZID0gTWF0aC5yYW5kb20oKSAqIDUgKiB1cE9yRG93bjtcclxuXHJcbiAgICAgIGNvbnN0IGN1cnJlbnRUaW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XHJcbiAgICAgIHRoaXMuI2xhc3RBY3Rpb25zLmNoYW5nZWREZWx0YVggPSBjdXJyZW50VGltZTtcclxuICAgICAgdGhpcy4jbGFzdEFjdGlvbnMuY2hhbmdlZERlbHRhWSA9IGN1cnJlbnRUaW1lO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgbW92ZSgpOiB2b2lkIHtcclxuICAgIHRoaXMubWF5YmVDaGFuZ2VEaXJlY3Rpb24oKTtcclxuICAgIHN1cGVyLm1vdmUoKTtcclxuICB9XHJcblxyXG4gIHNob290KGF0OiBQb3NpdGlvbkRldGFpbHMpOiB2b2lkIHtcclxuICAgIGlmICh0aGlzLnNob3VsZFNob290KSB7XHJcbiAgICAgIHRoaXMuI2xhc3RBY3Rpb25zLnNob3QgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcclxuICAgICAgc3VwZXIuc2hvb3QoYXQpO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBIZWFsdGggfSBmcm9tIFwiLi4vY29tcG9uZW50cy9oZWFsdGhcIjtcclxuaW1wb3J0IHsgU2hhcGUgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9zaGFwZVwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIE9ic3RhY2xlIGV4dGVuZHMgU2hhcGUge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgeDogbnVtYmVyLFxyXG4gICAgeTogbnVtYmVyLFxyXG4gICAgd2lkdGg6IG51bWJlcixcclxuICAgIGhlaWdodDogbnVtYmVyLFxyXG4gICAgcHVibGljIGhlYWx0aDogSGVhbHRoXHJcbiAgKSB7XHJcbiAgICBzdXBlcih4LCB5LCB3aWR0aCwgaGVpZ2h0KTtcclxuICB9XHJcblxyXG4gIGRyYXcoY3R4OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQpOiB2b2lkIHtcclxuICAgIC8vIE9ic3RhY2xlXHJcbiAgICBjdHguZmlsbFN0eWxlID0gXCIjNzA0MzAwXCI7XHJcbiAgICBjdHguZmlsbFJlY3QodGhpcy54LCB0aGlzLnksIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KTtcclxuXHJcbiAgICAvLyBPYnN0YWNsZSBIUCBiYXJcclxuICAgIGN0eC5maWxsU3R5bGUgPSB0aGlzLmhlYWx0aC5jdXJyZW50Q29sb3VyO1xyXG4gICAgY3R4LmZpbGxSZWN0KFxyXG4gICAgICB0aGlzLngsXHJcbiAgICAgIHRoaXMueSAtIDQwLFxyXG4gICAgICB0aGlzLmhlYWx0aC5jdXJyZW50UGVyY2VudGFnZSAqIHRoaXMud2lkdGgsXHJcbiAgICAgIDIwXHJcbiAgICApO1xyXG4gICAgY3R4LnN0cm9rZVN0eWxlID0gXCJibGFja1wiO1xyXG4gICAgY3R4LmxpbmVXaWR0aCA9IDI7XHJcbiAgICBjdHguc3Ryb2tlUmVjdCh0aGlzLngsIHRoaXMueSAtIDQwLCB0aGlzLndpZHRoLCAyMCk7XHJcbiAgfVxyXG59XHJcbiIsInR5cGUgSGVhbHRoQ29sb3VyID0gXCJncmVlblwiIHwgXCJ5ZWxsb3dcIiB8IFwicmVkXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgSGVhbHRoIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHByaXZhdGUgbWF4SGVhbHRoOiBudW1iZXIsXHJcbiAgICBwcml2YXRlIGN1cnJlbnRIZWFsdGg6IG51bWJlciA9IG1heEhlYWx0aFxyXG4gICkge31cclxuXHJcbiAgY2hhbmdlSGVhbHRoQnkoY2hhbmdlOiBudW1iZXIpOiB2b2lkIHtcclxuICAgIHRoaXMuY3VycmVudEhlYWx0aCA9IE1hdGgubWF4KDAsIHRoaXMuY3VycmVudEhlYWx0aCArIGNoYW5nZSk7XHJcbiAgfVxyXG5cclxuICBnZXQgaXNFbXB0eSgpOiBib29sZWFuIHtcclxuICAgIHJldHVybiB0aGlzLmN1cnJlbnRIZWFsdGggPT09IDA7XHJcbiAgfVxyXG5cclxuICBnZXQgY3VycmVudFBlcmNlbnRhZ2UoKTogbnVtYmVyIHtcclxuICAgIHJldHVybiB0aGlzLmN1cnJlbnRIZWFsdGggLyB0aGlzLm1heEhlYWx0aDtcclxuICB9XHJcblxyXG4gIGdldCBjdXJyZW50Q29sb3VyKCk6IEhlYWx0aENvbG91ciB7XHJcbiAgICBpZiAodGhpcy5jdXJyZW50UGVyY2VudGFnZSA+IDAuNikge1xyXG4gICAgICByZXR1cm4gXCJncmVlblwiO1xyXG4gICAgfSBlbHNlIGlmICh0aGlzLmN1cnJlbnRQZXJjZW50YWdlID4gMC40KSB7XHJcbiAgICAgIHJldHVybiBcInllbGxvd1wiO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIFwicmVkXCI7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IE1vdmFibGVTaGFwZSB9IGZyb20gXCIuL21vdmFibGVTaGFwZVwiO1xyXG5pbXBvcnQgeyBQb3NpdGlvbkRldGFpbHMgfSBmcm9tIFwiLi4vaW50ZXJmYWNlcy9wb3NpdGlvbkRldGFpbHNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBTaG90IGV4dGVuZHMgTW92YWJsZVNoYXBlIHtcclxuICBjb25zdHJ1Y3RvcihcclxuICAgIGZyb206IFBvc2l0aW9uRGV0YWlscyxcclxuICAgIHRvOiBQb3NpdGlvbkRldGFpbHMsXHJcbiAgICB3aWR0aDogbnVtYmVyID0gNSxcclxuICAgIGhlaWdodDogbnVtYmVyID0gNSxcclxuICAgIHB1YmxpYyBzcGVlZDogbnVtYmVyID0gMTUsXHJcbiAgICBwdWJsaWMgZGFtYWdlOiBudW1iZXIgPSAxMFxyXG4gICkge1xyXG4gICAgc3VwZXIoZnJvbS54LCBmcm9tLnksIHdpZHRoLCBoZWlnaHQsIDAsIDApO1xyXG5cclxuICAgIGNvbnN0IG9yaWdpbmFsRGVsdGEgPSB7XHJcbiAgICAgIGRlbHRhWDogdG8ueCAtIGZyb20ueCwgLy8gQSBpbiBDQUhcclxuICAgICAgZGVsdGFZOiB0by55IC0gZnJvbS55LCAvLyBPIGluIFNPSFxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCByYWRpYW5zID0gTWF0aC5hdGFuMihvcmlnaW5hbERlbHRhLmRlbHRhWSwgb3JpZ2luYWxEZWx0YS5kZWx0YVgpO1xyXG4gICAgdGhpcy5kZWx0YVggPSBNYXRoLmNvcyhyYWRpYW5zKSAqIHNwZWVkOyAvLyBDQUhcclxuICAgIHRoaXMuZGVsdGFZID0gTWF0aC5zaW4ocmFkaWFucykgKiBzcGVlZDsgLy8gU09IXHJcbiAgfVxyXG5cclxuICBkcmF3KGN0eDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEKTogdm9pZCB7XHJcbiAgICBjdHguZmlsbFN0eWxlID0gXCJnb2xkZW5yb2RcIjtcclxuICAgIGN0eC5maWxsUmVjdCh0aGlzLngsIHRoaXMueSwgNywgNyk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IFBvc2l0aW9uRGV0YWlscyB9IGZyb20gXCIuLi9pbnRlcmZhY2VzL3Bvc2l0aW9uRGV0YWlsc1wiO1xyXG5pbXBvcnQgeyBTaG90IH0gZnJvbSBcIi4vc2hvdFwiO1xyXG5cclxudHlwZSBmaWx0ZXJQcmVkaWNhdGUgPSAoc2hvdDogU2hvdCwgaW5kZXg6IG51bWJlciwgYXJyYXk6IFNob3RbXSkgPT4gYm9vbGVhbjtcclxuXHJcbmV4cG9ydCBjbGFzcyBTaG9vdGVyIHtcclxuICBzaG90c0ZpcmVkOiBTaG90W107XHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICB0aGlzLnNob3RzRmlyZWQgPSBbXTtcclxuICB9XHJcblxyXG4gIHNob290KGZyb206IFBvc2l0aW9uRGV0YWlscywgYXQ6IFBvc2l0aW9uRGV0YWlscyk6IHZvaWQge1xyXG4gICAgY29uc3Qgc2hvdCA9IG5ldyBTaG90KGZyb20sIGF0KTtcclxuICAgIHRoaXMuc2hvdHNGaXJlZC5wdXNoKHNob3QpO1xyXG4gIH1cclxuXHJcbiAgcmVtb3ZlKHNob3RUb1JlbW92ZTogU2hvdCk6IHZvaWQge1xyXG4gICAgdGhpcy5zaG90c0ZpcmVkID0gdGhpcy5zaG90c0ZpcmVkLmZpbHRlcigoc2hvdCkgPT4gc2hvdCAhPT0gc2hvdFRvUmVtb3ZlKTtcclxuICB9XHJcblxyXG4gIHJlbW92ZVNob3RzKC4uLnNob3RzVG9SZW1vdmU6IFNob3RbXSk6IHZvaWQge1xyXG4gICAgdGhpcy5zaG90c0ZpcmVkID0gdGhpcy5zaG90c0ZpcmVkLmZpbHRlcihcclxuICAgICAgKHNob3QpID0+ICFzaG90c1RvUmVtb3ZlLmluY2x1ZGVzKHNob3QpXHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAga2VlcFNob3RzV2hlcmUocHJlZGljYXRlOiBmaWx0ZXJQcmVkaWNhdGUpOiB2b2lkIHtcclxuICAgIHRoaXMuc2hvdHNGaXJlZCA9IHRoaXMuc2hvdHNGaXJlZC5maWx0ZXIocHJlZGljYXRlKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgQ29tcHV0ZXJQbGF5ZXIgfSBmcm9tIFwiLi9tb2RlbC9jbGFzc2VzL2NvbXB1dGVyUGxheWVyXCI7XHJcbmltcG9ydCB7IEh1bWFuUGxheWVyIH0gZnJvbSBcIi4vbW9kZWwvY2xhc3Nlcy9odW1hblBsYXllclwiO1xyXG5pbXBvcnQgeyBPYnN0YWNsZSB9IGZyb20gXCIuL21vZGVsL2NsYXNzZXMvb2JzdGFjbGVcIjtcclxuaW1wb3J0IHsgV29ybGQgfSBmcm9tIFwiLi9tb2RlbC9jbGFzc2VzL3dvcmxkXCI7XHJcbmltcG9ydCB7IEhlYWx0aCB9IGZyb20gXCIuL21vZGVsL2NvbXBvbmVudHMvaGVhbHRoXCI7XHJcbmltcG9ydCB7IFNob290ZXIgfSBmcm9tIFwiLi9tb2RlbC9jb21wb25lbnRzL3Nob290ZXJcIjtcclxuaW1wb3J0IHsgUGxheWVyIH0gZnJvbSBcIi4vbW9kZWwvY29tcG9uZW50cy9wbGF5ZXJcIjtcclxuaW1wb3J0IHsgQ29udHJvbHMgfSBmcm9tIFwiLi9tb2RlbC9jb21wb25lbnRzL2NvbnRyb2xzXCI7XHJcblxyXG5jb25zdCBiaWdHdXkgPSBuZXcgQ29tcHV0ZXJQbGF5ZXIoXHJcbiAgeyBuYW1lOiBcImJpZ19ndXkxOTU0ICjwn5al77iPKVwiLCBjb2xvdXI6IFwicHVycGxlXCIgfSxcclxuICAzMDAsXHJcbiAgMzAwLFxyXG4gIG5ldyBIZWFsdGgoNDAwKSxcclxuICBuZXcgU2hvb3RlcigpXHJcbik7XHJcblxyXG5jb25zdCBzdHJhbmdlT25lID0gbmV3IENvbXB1dGVyUGxheWVyKFxyXG4gIHsgbmFtZTogXCJzdHJhbmdlT25lNDUgKPCflqXvuI8pXCIsIGNvbG91cjogXCJyZWRcIiB9LFxyXG4gIDMwMCxcclxuICA1MCxcclxuICBuZXcgSGVhbHRoKDUwKSxcclxuICBuZXcgU2hvb3RlcigpLFxyXG4gIDIwLFxyXG4gIDIwXHJcbik7XHJcblxyXG5jb25zdCBtYWluQ29tcHV0ZXIgPSBuZXcgQ29tcHV0ZXJQbGF5ZXIoXHJcbiAgeyBuYW1lOiBcIjAxMDEwMTAxMDEgKPCflqXvuI8pXCIsIGNvbG91cjogXCJuYXZ5XCIgfSxcclxuICA0MDAsXHJcbiAgMjAwLFxyXG4gIG5ldyBIZWFsdGgoMTAwKSxcclxuICBuZXcgU2hvb3RlcigpXHJcbik7XHJcblxyXG5jb25zdCBodW1hblBsYXllciA9IG5ldyBIdW1hblBsYXllcihcclxuICB7IG5hbWU6IFwiWW91ICjwn46uKVwiLCBjb2xvdXI6IFwib2xpdmVcIiB9LFxyXG4gIDAsXHJcbiAgNDAwLFxyXG4gIG5ldyBIZWFsdGgoMjAwKSxcclxuICBuZXcgQ29udHJvbHMoZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImNhbnZhc1wiKSEsIHdpbmRvdyksXHJcbiAgbmV3IFNob290ZXIoKVxyXG4pO1xyXG5cclxuY29uc3QgcGxheWVyczogUGxheWVyW10gPSBbaHVtYW5QbGF5ZXIsIGJpZ0d1eSwgc3RyYW5nZU9uZSwgbWFpbkNvbXB1dGVyXTtcclxuXHJcbmNvbnN0IG9ic3RhY2xlcyA9IFtcclxuICBuZXcgT2JzdGFjbGUoMjAwLCAyMDAsIDUwLCA1MCwgbmV3IEhlYWx0aCgzMDApKSxcclxuICBuZXcgT2JzdGFjbGUoMTAwLCAzMDAsIDIwLCAxNTAsIG5ldyBIZWFsdGgoMzAwKSksXHJcbiAgbmV3IE9ic3RhY2xlKDYwMCwgNDAwLCA5MCwgNzAsIG5ldyBIZWFsdGgoMzAwKSksXHJcbl07XHJcblxyXG5jb25zdCB3b3JsZCA9IG5ldyBXb3JsZCg3MDAsIDUwMCk7XHJcblxyXG5leHBvcnQgY29uc3QgZGVmYXVsdENvbmZpZyA9IHtcclxuICBwbGF5ZXJzLFxyXG4gIG9ic3RhY2xlcyxcclxuICB3b3JsZCxcclxufTtcclxuIiwiaW1wb3J0IHsgQ29udHJvbHMgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9jb250cm9sc1wiO1xyXG5pbXBvcnQgeyBIZWFsdGggfSBmcm9tIFwiLi4vY29tcG9uZW50cy9oZWFsdGhcIjtcclxuaW1wb3J0IHsgUGxheWVyIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvcGxheWVyXCI7XHJcbmltcG9ydCB7IFNob290ZXIgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9zaG9vdGVyXCI7XHJcbmltcG9ydCB7IFBsYXllckRldGFpbHMgfSBmcm9tIFwiLi4vaW50ZXJmYWNlcy9wbGF5ZXJEZXRhaWxzXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgSHVtYW5QbGF5ZXIgZXh0ZW5kcyBQbGF5ZXIge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHVibGljIGRldGFpbHM6IFBsYXllckRldGFpbHMsXHJcbiAgICB4OiBudW1iZXIsXHJcbiAgICB5OiBudW1iZXIsXHJcbiAgICBwdWJsaWMgaGVhbHRoOiBIZWFsdGgsXHJcbiAgICBwdWJsaWMgY29udHJvbHM6IENvbnRyb2xzLFxyXG4gICAgcHVibGljIHNob290ZXI6IFNob290ZXIsXHJcbiAgICB3aWR0aDogbnVtYmVyID0gMTAwLFxyXG4gICAgaGVpZ2h0OiBudW1iZXIgPSAxMDAsXHJcbiAgICBkZWx0YVg6IG51bWJlciA9IDAsXHJcbiAgICBkZWx0YVk6IG51bWJlciA9IDBcclxuICApIHtcclxuICAgIHN1cGVyKGRldGFpbHMsIHgsIHksIGhlYWx0aCwgc2hvb3Rlciwgd2lkdGgsIGhlaWdodCwgZGVsdGFYLCBkZWx0YVkpO1xyXG4gICAgdGhpcy5jb250cm9scy5vbklucHV0SGFuZGxlciA9IChpbnB1dCwgbmV3U3RhdGUsIGV2ZW50KSA9PiB7XHJcbiAgICAgIGlmIChcIkxNQlwiID09PSBpbnB1dCAmJiBuZXdTdGF0ZSkge1xyXG4gICAgICAgIHN1cGVyLnNob290KHtcclxuICAgICAgICAgIHg6IChldmVudCBhcyBNb3VzZUV2ZW50KS54LFxyXG4gICAgICAgICAgeTogKGV2ZW50IGFzIE1vdXNlRXZlbnQpLnksXHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcbiAgICB0aGlzLm1vdmVtZW50QW1vdW50ID0gNTtcclxuICB9XHJcblxyXG4gIG1vdmUoKTogdm9pZCB7XHJcbiAgICBpZiAodGhpcy5jb250cm9scy5pbnB1dHMuS2V5Vykge1xyXG4gICAgICB0aGlzLmRlbHRhWSA9IC10aGlzLm1vdmVtZW50QW1vdW50O1xyXG4gICAgfSBlbHNlIGlmICh0aGlzLmNvbnRyb2xzLmlucHV0cy5LZXlTKSB7XHJcbiAgICAgIHRoaXMuZGVsdGFZID0gdGhpcy5tb3ZlbWVudEFtb3VudDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuZGVsdGFZID0gMDtcclxuICAgIH1cclxuXHJcbiAgICBpZiAodGhpcy5jb250cm9scy5pbnB1dHMuS2V5QSkge1xyXG4gICAgICB0aGlzLmRlbHRhWCA9IC10aGlzLm1vdmVtZW50QW1vdW50O1xyXG4gICAgfSBlbHNlIGlmICh0aGlzLmNvbnRyb2xzLmlucHV0cy5LZXlEKSB7XHJcbiAgICAgIHRoaXMuZGVsdGFYID0gdGhpcy5tb3ZlbWVudEFtb3VudDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHRoaXMuZGVsdGFYID0gMDtcclxuICAgIH1cclxuICAgIHN1cGVyLm1vdmUoKTtcclxuICB9XHJcbn1cclxuIiwiaW50ZXJmYWNlIENvbnRyb2xNYXAge1xyXG4gIFtjb250cm9sOiBzdHJpbmddOiBib29sZWFuO1xyXG59XHJcblxyXG50eXBlIGlucHV0SGFuZGxlciA9IChcclxuICBpbnB1dDogc3RyaW5nLFxyXG4gIG5ld1N0YXRlOiBib29sZWFuLFxyXG4gIGU6IE1vdXNlRXZlbnQgfCBLZXlib2FyZEV2ZW50XHJcbikgPT4gdm9pZDtcclxuXHJcbmV4cG9ydCBjbGFzcyBDb250cm9scyB7XHJcbiAgaW5wdXRzOiBDb250cm9sTWFwO1xyXG4gICNvbklucHV0OiBpbnB1dEhhbmRsZXI7XHJcblxyXG4gIGNvbnN0cnVjdG9yKGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnQsIHdpbmRvdzogV2luZG93KSB7XHJcbiAgICAvLyBNaWdodCBiZSB3b3J0aCBzZXR0aW5nIHRoaXMgb2JqZWN0IHVwIGFzIGEgcHJveHk/XHJcbiAgICB0aGlzLmlucHV0cyA9IHtcclxuICAgICAgS2V5VzogZmFsc2UsXHJcbiAgICAgIEtleUE6IGZhbHNlLFxyXG4gICAgICBLZXlTOiBmYWxzZSxcclxuICAgICAgS2V5RDogZmFsc2UsXHJcbiAgICAgIExNQjogZmFsc2UsXHJcbiAgICB9O1xyXG4gICAgdGhpcy4jb25JbnB1dCA9IChpbnB1dCwgbmV3VmFsdWUpID0+IGNvbnNvbGUubG9nKHsgaW5wdXQsIG5ld1ZhbHVlIH0pO1xyXG5cclxuICAgIGNvbnN0IGNsaWNrTGlzdGVuZXIgPSAoZTogTW91c2VFdmVudCkgPT4ge1xyXG4gICAgICBpZiAoMCA9PT0gZS5idXR0b24pIHtcclxuICAgICAgICB0aGlzLmlucHV0cy5MTUIgPSBlLnR5cGUgPT09IFwibW91c2Vkb3duXCI7XHJcbiAgICAgICAgdGhpcy4jb25JbnB1dChcIkxNQlwiLCB0aGlzLmlucHV0cy5MTUIsIGUpO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IGtleUxpc3RlbmVyID0gKGU6IEtleWJvYXJkRXZlbnQpID0+IHtcclxuICAgICAgY29uc3QgeyBjb2RlIH0gPSBlO1xyXG4gICAgICBpZiAodGhpcy5pbnB1dHMuaGFzT3duUHJvcGVydHkoY29kZSkpIHtcclxuICAgICAgICB0aGlzLmlucHV0c1tjb2RlXSA9IGUudHlwZSA9PT0gXCJrZXlkb3duXCI7XHJcbiAgICAgICAgdGhpcy4jb25JbnB1dChjb2RlLCB0aGlzLmlucHV0c1tjb2RlXSwgZSk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZXVwXCIsIGNsaWNrTGlzdGVuZXIpO1xyXG4gICAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgY2xpY2tMaXN0ZW5lcik7XHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImtleXVwXCIsIGtleUxpc3RlbmVyKTtcclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCBrZXlMaXN0ZW5lcik7XHJcbiAgfVxyXG5cclxuICBzZXQgb25JbnB1dEhhbmRsZXIobmV3SGFuZGxlcjogaW5wdXRIYW5kbGVyKSB7XHJcbiAgICB0aGlzLiNvbklucHV0ID0gbmV3SGFuZGxlcjtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgU2hhcGUgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9zaGFwZVwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFdvcmxkIGV4dGVuZHMgU2hhcGUge1xyXG4gIGNvbnN0cnVjdG9yKHdpZHRoOiBudW1iZXIsIGhlaWdodDogbnVtYmVyKSB7XHJcbiAgICBzdXBlcigwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcclxuICB9XHJcblxyXG4gIGRyYXcoKTogdm9pZCB7fVxyXG59XHJcbiIsImltcG9ydCB7IGRlZmF1bHRDb25maWcgfSBmcm9tIFwiLi9kZWZhdWx0R2FtZVwiO1xyXG5pbXBvcnQgeyBHYW1lIH0gZnJvbSBcIi4vbW9kZWwvY2xhc3Nlcy9nYW1lXCI7XHJcblxyXG5jb25zdCB7IHdvcmxkLCBwbGF5ZXJzLCBvYnN0YWNsZXMgfSA9IGRlZmF1bHRDb25maWc7XHJcbmNvbnN0IGNhbnZhcyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJjYW52YXNcIikhO1xyXG5cclxuY29uc3QgZ2FtZSA9IG5ldyBHYW1lKHdvcmxkLCBwbGF5ZXJzLCBvYnN0YWNsZXMsIGNhbnZhcyk7XHJcbmdhbWUucGxheSgpO1xyXG5cclxuLy8gT2JqZWN0LmFzc2lnbih3aW5kb3csIHsgZ2FtZSB9KTtcclxuIiwiaW1wb3J0IHsgUGxheWVyIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvcGxheWVyXCI7XHJcbmltcG9ydCB7IENvbXB1dGVyUGxheWVyIH0gZnJvbSBcIi4vY29tcHV0ZXJQbGF5ZXJcIjtcclxuaW1wb3J0IHsgT2JzdGFjbGUgfSBmcm9tIFwiLi9vYnN0YWNsZVwiO1xyXG5pbXBvcnQgeyBXb3JsZCB9IGZyb20gXCIuL3dvcmxkXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgR2FtZSB7XHJcbiAgI2N0eDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEO1xyXG5cclxuICBjb25zdHJ1Y3RvcihcclxuICAgIHByaXZhdGUgd29ybGQ6IFdvcmxkLFxyXG4gICAgcHJpdmF0ZSBwbGF5ZXJzOiBQbGF5ZXJbXSxcclxuICAgIHByaXZhdGUgb2JzdGFjbGVzOiBPYnN0YWNsZVtdLFxyXG4gICAgcHJpdmF0ZSBjYW52YXM6IEhUTUxDYW52YXNFbGVtZW50XHJcbiAgKSB7XHJcbiAgICB0aGlzLmNhbnZhcy5oZWlnaHQgPSB0aGlzLndvcmxkLmhlaWdodDtcclxuICAgIHRoaXMuY2FudmFzLndpZHRoID0gdGhpcy53b3JsZC53aWR0aDtcclxuICAgIHRoaXMuI2N0eCA9IHRoaXMuY2FudmFzLmdldENvbnRleHQoXCIyZFwiKSE7XHJcbiAgfVxyXG5cclxuICBnZXQgY29tcHV0ZXJQbGF5ZXJzKCk6IENvbXB1dGVyUGxheWVyW10ge1xyXG4gICAgcmV0dXJuIHRoaXMucGxheWVycy5maWx0ZXIoXHJcbiAgICAgIChwbGF5ZXIpID0+IHBsYXllciBpbnN0YW5jZW9mIENvbXB1dGVyUGxheWVyXHJcbiAgICApIGFzIENvbXB1dGVyUGxheWVyW107XHJcbiAgfVxyXG5cclxuICBvdGhlclBsYXllcnMocGxheWVyVG9FeGNsdWRlOiBQbGF5ZXIpOiBQbGF5ZXJbXSB7XHJcbiAgICByZXR1cm4gdGhpcy5wbGF5ZXJzLmZpbHRlcigocGxheWVyKSA9PiBwbGF5ZXIgIT09IHBsYXllclRvRXhjbHVkZSk7XHJcbiAgfVxyXG5cclxuICB1cGRhdGVQb3NpdGlvbnMoKTogdm9pZCB7XHJcbiAgICBmb3IgKGNvbnN0IGNvbXB1dGVyUGxheWVyIG9mIHRoaXMuY29tcHV0ZXJQbGF5ZXJzKSB7XHJcbiAgICAgIGNvbnN0IHBsYXllclRvU2hvb3QgPSB0aGlzLnBsYXllcnMuZmluZChcclxuICAgICAgICAocGxheWVyKSA9PiBwbGF5ZXIgIT09IGNvbXB1dGVyUGxheWVyXHJcbiAgICAgICkhO1xyXG4gICAgICBjb21wdXRlclBsYXllci5zaG9vdCh7XHJcbiAgICAgICAgeDogcGxheWVyVG9TaG9vdC5jZW50ZXIueCxcclxuICAgICAgICB5OiBwbGF5ZXJUb1Nob290LmNlbnRlci55LFxyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICB0aGlzLnBsYXllcnMgPSB0aGlzLnBsYXllcnMuZmlsdGVyKChwbGF5ZXIpID0+ICFwbGF5ZXIuaGVhbHRoLmlzRW1wdHkpO1xyXG5cclxuICAgIGZvciAoY29uc3QgcGxheWVyIG9mIHRoaXMucGxheWVycykge1xyXG4gICAgICBwbGF5ZXIubW92ZSgpO1xyXG5cclxuICAgICAgLy8gVE9ETzogdGhpcyBpcyBxdWFkcmF0aWMgYmVoYXZpb3VyIChhbmQgd2lsbCBzY2FsZSBwb29ybHkpLCBidXQgbWlnaHQgbm90IGhhdmUgZW5vdWdoXHJcbiAgICAgIC8vIG9iamVjdHMvY29tcGFyaXNvbnMgdG8gd2FycmFudCBhIG1vcmUgZWZmaWNpZW50IHN0cnVjdHVyZVxyXG4gICAgICAvLyBlLmcgcXVhZHRyZWUsIG9jdG90cmVlLlxyXG4gICAgICBpZiAoXHJcbiAgICAgICAgcGxheWVyLmV4dGVuZHNCZXlvbmQodGhpcy53b3JsZCkgfHxcclxuICAgICAgICBwbGF5ZXIuY29sbGlkZXNXaXRoQW55KC4uLnRoaXMub3RoZXJQbGF5ZXJzKHBsYXllcikpIHx8XHJcbiAgICAgICAgcGxheWVyLmNvbGxpZGVzV2l0aEFueSguLi50aGlzLm9ic3RhY2xlcylcclxuICAgICAgKSB7XHJcbiAgICAgICAgcGxheWVyLm1vdmVCYWNrKCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGZvciAoY29uc3Qgc2hvdCBvZiBwbGF5ZXIuc2hvb3Rlci5zaG90c0ZpcmVkKSB7XHJcbiAgICAgICAgc2hvdC5tb3ZlKCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIHRoaXMucHJvY2Vzc0NvbGxpc2lvbnMoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHByb2Nlc3NDb2xsaXNpb25zKCk6IHZvaWQge1xyXG4gICAgZm9yIChjb25zdCBwbGF5ZXIgb2YgdGhpcy5wbGF5ZXJzKSB7XHJcbiAgICAgIHBsYXllci5zaG9vdGVyLmtlZXBTaG90c1doZXJlKChzaG90KSA9PiB7XHJcbiAgICAgICAgLy8gRG9lcyBzaG90IGNvbGxpZGUgd2l0aCBhbnkgb2JzdGFjbGVzP1xyXG4gICAgICAgIGNvbnN0IG9ic3RhY2xlc1Nob3QgPSBzaG90LmdldEFsbENvbGxpc2lvbnNXaXRoKC4uLnRoaXMub2JzdGFjbGVzKTtcclxuICAgICAgICBvYnN0YWNsZXNTaG90LmZvckVhY2goKG9ic3RhY2xlKSA9PlxyXG4gICAgICAgICAgb2JzdGFjbGUuaGVhbHRoLmNoYW5nZUhlYWx0aEJ5KC1zaG90LmRhbWFnZSlcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICAvLyBEb2VzIHNob3QgY29sbGlkZSB3aXRoIGFueSBwbGF5ZXJzP1xyXG4gICAgICAgIGNvbnN0IHBsYXllcnNTaG90ID0gc2hvdC5nZXRBbGxDb2xsaXNpb25zV2l0aChcclxuICAgICAgICAgIC4uLnRoaXMub3RoZXJQbGF5ZXJzKHBsYXllcilcclxuICAgICAgICApO1xyXG4gICAgICAgIHBsYXllcnNTaG90LmZvckVhY2goKHBsYXllcikgPT5cclxuICAgICAgICAgIHBsYXllci5oZWFsdGguY2hhbmdlSGVhbHRoQnkoLXNob3QuZGFtYWdlKVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIHJldHVybiAoXHJcbiAgICAgICAgICBvYnN0YWNsZXNTaG90Lmxlbmd0aCA9PT0gMCAmJlxyXG4gICAgICAgICAgcGxheWVyc1Nob3QubGVuZ3RoID09PSAwICYmXHJcbiAgICAgICAgICAvLyBIYXMgc2hvdCBsZWZ0IHRoZSB3b3JsZC92aWV3IHNjb3BlP1xyXG4gICAgICAgICAgIXNob3QuZXh0ZW5kc0JleW9uZCh0aGlzLndvcmxkKVxyXG4gICAgICAgICk7XHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMub2JzdGFjbGVzID0gdGhpcy5vYnN0YWNsZXMuZmlsdGVyKFxyXG4gICAgICAob2JzdGFjbGUpID0+ICFvYnN0YWNsZS5oZWFsdGguaXNFbXB0eVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIGRyYXcoKTogdm9pZCB7XHJcbiAgICB0aGlzLiNjdHguY2xlYXJSZWN0KDAsIDAsIHRoaXMuY2FudmFzLndpZHRoLCB0aGlzLmNhbnZhcy5oZWlnaHQpO1xyXG4gICAgZm9yIChjb25zdCBwbGF5ZXIgb2YgdGhpcy5wbGF5ZXJzKSB7XHJcbiAgICAgIHBsYXllci5kcmF3KHRoaXMuI2N0eCk7XHJcblxyXG4gICAgICBmb3IgKGNvbnN0IHNob3Qgb2YgcGxheWVyLnNob290ZXIuc2hvdHNGaXJlZCkge1xyXG4gICAgICAgIHNob3QuZHJhdyh0aGlzLiNjdHgpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICBmb3IgKGNvbnN0IG9ic3RhY2xlIG9mIHRoaXMub2JzdGFjbGVzKSB7XHJcbiAgICAgICAgb2JzdGFjbGUuZHJhdyh0aGlzLiNjdHgpO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBnZXRXaW5uZXJPck51bGwoKTogUGxheWVyIHwgbnVsbCB7XHJcbiAgICBjb25zdCByZW1haW5pbmdQbGF5ZXJzID0gdGhpcy5wbGF5ZXJzLmZpbHRlcihcclxuICAgICAgKHBsYXllcikgPT4gIXBsYXllci5oZWFsdGguaXNFbXB0eVxyXG4gICAgKTtcclxuXHJcbiAgICByZXR1cm4gcmVtYWluaW5nUGxheWVycy5sZW5ndGggPT09IDEgPyByZW1haW5pbmdQbGF5ZXJzWzBdIDogbnVsbDtcclxuICB9XHJcblxyXG4gIHBsYXkoKTogdm9pZCB7XHJcbiAgICB0aGlzLnVwZGF0ZVBvc2l0aW9ucygpO1xyXG4gICAgdGhpcy5kcmF3KCk7XHJcbiAgICBjb25zdCB3aW5uZXJPck51bGwgPSB0aGlzLmdldFdpbm5lck9yTnVsbCgpO1xyXG4gICAgaWYgKHdpbm5lck9yTnVsbCkge1xyXG4gICAgICBzZXRUaW1lb3V0KCgpID0+IGFsZXJ0KGAke3dpbm5lck9yTnVsbC5kZXRhaWxzLm5hbWV9IHdvbiFgKSwgMTApO1xyXG4gICAgICByZXR1cm47XHJcbiAgICB9XHJcblxyXG4gICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKHRoaXMucGxheS5iaW5kKHRoaXMpKTtcclxuICB9XHJcbn1cclxuIl0sInNvdXJjZVJvb3QiOiIifQ==