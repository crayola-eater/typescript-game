(()=>{"use strict";class t{constructor(t,e=t){this.maxHealth=t,this.currentHealth=e}changeHealthBy(t){this.currentHealth=Math.max(0,this.currentHealth+t)}get isEmpty(){return 0===this.currentHealth}get currentPercentage(){return this.currentHealth/this.maxHealth}get currentColour(){return this.currentPercentage>.6?"green":this.currentPercentage>.4?"yellow":"red"}}class e{constructor(t,e,s,i){this.x=t,this.y=e,this.width=s,this.height=i}collidesWith(t){return this.topLeft.x<t.bottomRight.x&&this.bottomRight.x>t.topLeft.x&&this.topLeft.y<t.bottomRight.y&&this.bottomRight.y>t.topRight.y}collidesWithAny(...t){return t.some((t=>this.collidesWith(t)))}extendsBeyond(t){return this.topLeft.x<t.topLeft.x||this.bottomRight.x>t.bottomRight.x||this.topLeft.y<t.topLeft.y||this.bottomRight.y>t.bottomRight.y}getAllCollisionsWith(...t){return t.filter((t=>this.collidesWith(t)))}get topLeft(){return{x:this.x,y:this.y}}get topRight(){return{x:this.x+this.width,y:this.y}}get bottomLeft(){return{x:this.x,y:this.y+this.height}}get bottomRight(){return{x:this.x+this.width,y:this.y+this.height}}get center(){return{x:this.x+this.width/2,y:this.y+this.height/2}}}class s extends e{constructor(t,e,s,i,h=0,o=0,n=5){super(t,e,s,i),this.deltaX=h,this.deltaY=o,this.movementAmount=n}moveBy(t,e){this.x+=t,this.y+=e}move(){this.x+=this.deltaX,this.y+=this.deltaY}moveBack(){this.moveBy(-this.deltaX,-this.deltaY)}}class i extends s{constructor(t,e,s=5,i=5,h=15,o=10){super(t.x,t.y,s,i,0,0),this.speed=h,this.damage=o;const n={deltaX:e.x-t.x,deltaY:e.y-t.y},r=Math.atan2(n.deltaY,n.deltaX);this.deltaX=Math.cos(r)*h,this.deltaY=Math.sin(r)*h}}class h{constructor(){this.shotsFired=[]}shoot(t,e){const s=new i(t,e);this.shotsFired.push(s)}remove(t){this.shotsFired=this.shotsFired.filter((e=>t!==e))}}var o,n=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)};class r extends s{constructor(t,e,s,i,h=100,n=100){super(t,e,h,n),this.health=s,this.shooter=i,o.set(this,void 0);const r=(new Date).getTime();!function(t,e,s){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");e.set(t,s)}(this,o,{changedDeltaX:r,changedDeltaY:r,shot:r})}get shouldChangeDirection(){return(new Date).getTime()>n(this,o).changedDeltaX+100}get shouldShoot(){return(new Date).getTime()>n(this,o).shot+2e3}maybeChangeDirection(){if(this.shouldChangeDirection){const t=Math.random()<.5?-1:1;this.deltaX=5*Math.random()*t;const e=Math.random()<.5?-1:1;this.deltaY=5*Math.random()*e;const s=(new Date).getTime();n(this,o).changedDeltaX=s,n(this,o).changedDeltaY=s}}move(){this.maybeChangeDirection(),super.move()}shoot(t){this.shouldShoot&&this.shooter.shoot({x:this.center.x,y:this.center.y},{x:t.x,y:t.y})}}o=new WeakMap;const a=function(){const e=new t(100),s=new h;return new r(600,200,e,s)}();var l,c=function(t,e,s){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,s),s},d=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)};class u{constructor(t,e){l.set(this,void 0),this.inputs={KeyW:!1,KeyA:!1,KeyS:!1,KeyD:!1,LMB:!1},c(this,l,((t,e)=>console.log({input:t,newValue:e})));const s=t=>{0===t.button&&(this.inputs.LMB="mousedown"===t.type,d(this,l).call(this,"LMB",this.inputs.LMB,t))},i=t=>{const{code:e}=t;this.inputs.hasOwnProperty(e)&&(this.inputs[e]="keydown"===t.type,d(this,l).call(this,e,this.inputs[e],t))};t.addEventListener("mouseup",s),t.addEventListener("mousedown",s),e.addEventListener("keyup",i),e.addEventListener("keydown",i)}set onInputHandler(t){c(this,l,t)}}l=new WeakMap;class y extends s{constructor(t,e,s,i,h,o=100,n=100,r=0,a=0){super(t,e,o,n,r,a),this.health=s,this.controls=i,this.shooter=h,this.controls.onInputHandler=(t,e,s)=>{"LMB"===t&&e&&this.shooter.shoot({x:this.center.x,y:this.center.y},{x:s.x,y:s.y})},this.movementAmount=5}move(){this.controls.inputs.KeyW?this.deltaY=-this.movementAmount:this.controls.inputs.KeyS?this.deltaY=this.movementAmount:this.deltaY=0,this.controls.inputs.KeyA?this.deltaX=-this.movementAmount:this.controls.inputs.KeyD?this.deltaX=this.movementAmount:this.deltaX=0,super.move()}}const m=function(){const e=new t(100),s=new u(document.querySelector("canvas"),window),i=new h;return new y(300,100,e,s,i)}();class p extends e{constructor(t,e,s,i,h){super(t,e,s,i),this.health=h}}const g={players:[m,a],obstacles:[new p(200,200,50,50,new t(200)),new p(300,300,20,150,new t(200)),new p(600,400,90,70,new t(200))],world:new class extends e{constructor(t=800,e=500){super(0,0,t,e)}}};var w,f,x=function(t,e,s){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,s),s},v=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)};w=new WeakMap,f=new WeakMap;const{world:b,players:R,obstacles:L}=g,M=document.querySelector("canvas");new class{constructor(t,e,s,i){this.world=t,this.players=e,this.obstacles=s,this.canvas=i,w.set(this,void 0),f.set(this,void 0),this.canvas.height=this.world.height,this.canvas.width=this.world.width,x(this,w,this.canvas.getContext("2d")),x(this,f,!1)}otherPlayers(t){return this.players.filter((e=>e!==t))}play(){v(this,w).clearRect(0,0,this.canvas.width,this.canvas.height);for(const t of this.players){t.move(),(t.extendsBeyond(this.world)||t.collidesWithAny(...this.otherPlayers(t))||t.collidesWithAny(...this.obstacles))&&t.moveBack(),v(this,w).fillStyle="red",v(this,w).fillRect(t.x,t.y,t.width,t.height),v(this,w).fillStyle=t.health.currentColour,v(this,w).fillRect(t.x,t.y-40,t.health.currentPercentage*t.width,20),v(this,w).strokeStyle="black",v(this,w).lineWidth=2,v(this,w).strokeRect(t.x,t.y-40,t.width,20);for(const e of t.shooter.shotsFired){if(e.move(),e.extendsBeyond(this.world)){t.shooter.remove(e);continue}const s=e.getAllCollisionsWith(...this.obstacles);s.forEach((t=>t.health.changeHealthBy(-e.damage)));const i=e.getAllCollisionsWith(...this.otherPlayers(t));for(const t of i)if(t.health.changeHealthBy(-e.damage),t.health.isEmpty)return x(this,f,!1),alert(t+" lost!");s.length>0||i.length>0?t.shooter.remove(e):(v(this,w).fillStyle="goldenrod",v(this,w).fillRect(e.x,e.y,7,7))}for(const t of this.obstacles)v(this,w).fillStyle="#704300",v(this,w).fillRect(t.x,t.y,t.width,t.height),v(this,w).fillStyle=t.health.currentColour,v(this,w).fillRect(t.x,t.y-40,t.health.currentPercentage*t.width,20),v(this,w).strokeStyle="black",v(this,w).lineWidth=2,v(this,w).strokeRect(t.x,t.y-40,t.width,20)}requestAnimationFrame(this.play.bind(this))}}(b,R,L,M).play()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zbWFsbC1nYW1lLy4vc3JjL21vZGVsL2NvbXBvbmVudHMvaGVhbHRoLnRzIiwid2VicGFjazovL3NtYWxsLWdhbWUvLi9zcmMvbW9kZWwvY29tcG9uZW50cy9zaGFwZS50cyIsIndlYnBhY2s6Ly9zbWFsbC1nYW1lLy4vc3JjL21vZGVsL2NvbXBvbmVudHMvbW92YWJsZVNoYXBlLnRzIiwid2VicGFjazovL3NtYWxsLWdhbWUvLi9zcmMvbW9kZWwvY29tcG9uZW50cy9zaG90LnRzIiwid2VicGFjazovL3NtYWxsLWdhbWUvLi9zcmMvbW9kZWwvY29tcG9uZW50cy9zaG9vdGVyLnRzIiwid2VicGFjazovL3NtYWxsLWdhbWUvLi9zcmMvbW9kZWwvY2xhc3Nlcy9jb21wdXRlclBsYXllci50cyIsIndlYnBhY2s6Ly9zbWFsbC1nYW1lLy4vc3JjL21vZGVsL2NvbXBvbmVudHMvY29udHJvbHMudHMiLCJ3ZWJwYWNrOi8vc21hbGwtZ2FtZS8uL3NyYy9tb2RlbC9jbGFzc2VzL2h1bWFuUGxheWVyLnRzIiwid2VicGFjazovL3NtYWxsLWdhbWUvLi9zcmMvbW9kZWwvY2xhc3Nlcy9vYnN0YWNsZS50cyIsIndlYnBhY2s6Ly9zbWFsbC1nYW1lLy4vc3JjL2RlZmF1bHRHYW1lLnRzIiwid2VicGFjazovL3NtYWxsLWdhbWUvLi9zcmMvbW9kZWwvY2xhc3Nlcy93b3JsZC50cyIsIndlYnBhY2s6Ly9zbWFsbC1nYW1lLy4vc3JjL2luZGV4LnRzIiwid2VicGFjazovL3NtYWxsLWdhbWUvLi9zcmMvbW9kZWwvY2xhc3Nlcy9nYW1lLnRzIl0sIm5hbWVzIjpbIkhlYWx0aCIsIm1heEhlYWx0aCIsImN1cnJlbnRIZWFsdGgiLCJjaGFuZ2UiLCJ0aGlzIiwiTWF0aCIsIm1heCIsImN1cnJlbnRQZXJjZW50YWdlIiwiU2hhcGUiLCJ4IiwieSIsIndpZHRoIiwiaGVpZ2h0Iiwib3RoZXJTaGFwZSIsInRvcExlZnQiLCJib3R0b21SaWdodCIsInRvcFJpZ2h0Iiwib3RoZXJTaGFwZXMiLCJzb21lIiwiY29sbGlkZXNXaXRoIiwiZmlsdGVyIiwiTW92YWJsZVNoYXBlIiwiZGVsdGFYIiwiZGVsdGFZIiwibW92ZW1lbnRBbW91bnQiLCJzdXBlciIsIm1vdmVCeSIsIlNob3QiLCJmcm9tIiwidG8iLCJzcGVlZCIsImRhbWFnZSIsIm9yaWdpbmFsRGVsdGEiLCJyYWRpYW5zIiwiYXRhbjIiLCJjb3MiLCJzaW4iLCJTaG9vdGVyIiwic2hvdHNGaXJlZCIsImF0Iiwic2hvdCIsInB1c2giLCJzaG90VG9SZW1vdmUiLCJDb21wdXRlclBsYXllciIsImhlYWx0aCIsInNob290ZXIiLCJjdXJyZW50VGltZSIsIkRhdGUiLCJnZXRUaW1lIiwiY2hhbmdlZERlbHRhWCIsImNoYW5nZWREZWx0YVkiLCJzaG91bGRDaGFuZ2VEaXJlY3Rpb24iLCJsZWZ0T3JSaWdodCIsInJhbmRvbSIsInVwT3JEb3duIiwibWF5YmVDaGFuZ2VEaXJlY3Rpb24iLCJtb3ZlIiwic2hvdWxkU2hvb3QiLCJzaG9vdCIsImNlbnRlciIsImRlZmF1bHRDb21wdXRlclBsYXllciIsImNyZWF0ZURlZmF1bHRDb21wdXRlclBsYXllciIsIkNvbnRyb2xzIiwiY2FudmFzIiwid2luZG93IiwiaW5wdXRzIiwiS2V5VyIsIktleUEiLCJLZXlTIiwiS2V5RCIsIkxNQiIsImlucHV0IiwibmV3VmFsdWUiLCJjb25zb2xlIiwibG9nIiwiY2xpY2tMaXN0ZW5lciIsImUiLCJidXR0b24iLCJ0eXBlIiwia2V5TGlzdGVuZXIiLCJjb2RlIiwiaGFzT3duUHJvcGVydHkiLCJhZGRFdmVudExpc3RlbmVyIiwibmV3SGFuZGxlciIsIkh1bWFuUGxheWVyIiwiY29udHJvbHMiLCJvbklucHV0SGFuZGxlciIsIm5ld1N0YXRlIiwiZXZlbnQiLCJkZWZhdWx0SHVtYW5QbGF5ZXIiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJjcmVhdGVEZWZhdWx0SHVtYW5QbGF5ZXIiLCJPYnN0YWNsZSIsImRlZmF1bHRDb25maWciLCJwbGF5ZXJzIiwib2JzdGFjbGVzIiwid29ybGQiLCJnZXRDb250ZXh0IiwicGxheWVyVG9FeGNsdWRlIiwicGxheWVyIiwiY2xlYXJSZWN0IiwiZXh0ZW5kc0JleW9uZCIsImNvbGxpZGVzV2l0aEFueSIsIm90aGVyUGxheWVycyIsIm1vdmVCYWNrIiwiZmlsbFN0eWxlIiwiZmlsbFJlY3QiLCJjdXJyZW50Q29sb3VyIiwic3Ryb2tlU3R5bGUiLCJsaW5lV2lkdGgiLCJzdHJva2VSZWN0IiwicmVtb3ZlIiwib2JzdGFjbGVzU2hvdCIsImdldEFsbENvbGxpc2lvbnNXaXRoIiwiZm9yRWFjaCIsIm9ic3RhY2xlIiwiY2hhbmdlSGVhbHRoQnkiLCJwbGF5ZXJzU2hvdCIsImlzRW1wdHkiLCJhbGVydCIsImxlbmd0aCIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsInBsYXkiLCJiaW5kIl0sIm1hcHBpbmdzIjoibUJBRU8sTUFBTUEsRUFDWCxZQUNVQyxFQUNBQyxFQUF3QkQsR0FEeEIsS0FBQUEsWUFDQSxLQUFBQyxnQkFHVixlQUFlQyxHQUNiQyxLQUFLRixjQUFnQkcsS0FBS0MsSUFBSSxFQUFHRixLQUFLRixjQUFnQkMsR0FHeEQsY0FDRSxPQUE4QixJQUF2QkMsS0FBS0YsY0FHZCx3QkFDRSxPQUFPRSxLQUFLRixjQUFnQkUsS0FBS0gsVUFHbkMsb0JBQ0UsT0FBSUcsS0FBS0csa0JBQW9CLEdBQ3BCLFFBQ0VILEtBQUtHLGtCQUFvQixHQUMzQixTQUVGLE9DakJKLE1BQU1DLEVBQ1gsWUFDU0MsRUFDQUMsRUFDQUMsRUFDQUMsR0FIQSxLQUFBSCxJQUNBLEtBQUFDLElBQ0EsS0FBQUMsUUFDQSxLQUFBQyxTQUdULGFBQWFDLEdBQ1gsT0FDRVQsS0FBS1UsUUFBUUwsRUFBSUksRUFBV0UsWUFBWU4sR0FDeENMLEtBQUtXLFlBQVlOLEVBQUlJLEVBQVdDLFFBQVFMLEdBQ3hDTCxLQUFLVSxRQUFRSixFQUFJRyxFQUFXRSxZQUFZTCxHQUN4Q04sS0FBS1csWUFBWUwsRUFBSUcsRUFBV0csU0FBU04s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QUFPLElBSXRFK0csc0JBQXNCdEgsS0FBS3VILEtBQUtDLEtBQUt4SCxTRDVIbkIsRUFBTyxFQUFTLEVBQVcyRCxHQUM1QzRELFEiLCJmaWxlIjoiYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsidHlwZSBIZWFsdGhDb2xvdXIgPSBcImdyZWVuXCIgfCBcInllbGxvd1wiIHwgXCJyZWRcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBIZWFsdGgge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHJpdmF0ZSBtYXhIZWFsdGg6IG51bWJlcixcclxuICAgIHByaXZhdGUgY3VycmVudEhlYWx0aDogbnVtYmVyID0gbWF4SGVhbHRoXHJcbiAgKSB7fVxyXG5cclxuICBjaGFuZ2VIZWFsdGhCeShjaGFuZ2U6IG51bWJlcikge1xyXG4gICAgdGhpcy5jdXJyZW50SGVhbHRoID0gTWF0aC5tYXgoMCwgdGhpcy5jdXJyZW50SGVhbHRoICsgY2hhbmdlKTtcclxuICB9XHJcblxyXG4gIGdldCBpc0VtcHR5KCk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIHRoaXMuY3VycmVudEhlYWx0aCA9PT0gMDtcclxuICB9XHJcblxyXG4gIGdldCBjdXJyZW50UGVyY2VudGFnZSgpOiBudW1iZXIge1xyXG4gICAgcmV0dXJuIHRoaXMuY3VycmVudEhlYWx0aCAvIHRoaXMubWF4SGVhbHRoO1xyXG4gIH1cclxuXHJcbiAgZ2V0IGN1cnJlbnRDb2xvdXIoKTogSGVhbHRoQ29sb3VyIHtcclxuICAgIGlmICh0aGlzLmN1cnJlbnRQZXJjZW50YWdlID4gMC42KSB7XHJcbiAgICAgIHJldHVybiBcImdyZWVuXCI7XHJcbiAgICB9IGVsc2UgaWYgKHRoaXMuY3VycmVudFBlcmNlbnRhZ2UgPiAwLjQpIHtcclxuICAgICAgcmV0dXJuIFwieWVsbG93XCI7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gXCJyZWRcIjtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgSVBvc2l0aW9uIH0gZnJvbSBcIi4uL2ludGVyZmFjZXMvcG9zaXRpb25cIjtcclxuXHJcbmV4cG9ydCBpbnRlcmZhY2UgU2hhcGVPcHRpb25zIHtcclxuICB4OiBudW1iZXI7XHJcbiAgeTogbnVtYmVyO1xyXG4gIGhlaWdodDogbnVtYmVyO1xyXG4gIHdpZHRoOiBudW1iZXI7XHJcbn1cclxuXHJcbmV4cG9ydCBjbGFzcyBTaGFwZSB7XHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBwdWJsaWMgeDogbnVtYmVyLFxyXG4gICAgcHVibGljIHk6IG51bWJlcixcclxuICAgIHB1YmxpYyB3aWR0aDogbnVtYmVyLFxyXG4gICAgcHVibGljIGhlaWdodDogbnVtYmVyXHJcbiAgKSB7fVxyXG5cclxuICBjb2xsaWRlc1dpdGgob3RoZXJTaGFwZTogU2hhcGUpOiBib29sZWFuIHtcclxuICAgIHJldHVybiAoXHJcbiAgICAgIHRoaXMudG9wTGVmdC54IDwgb3RoZXJTaGFwZS5ib3R0b21SaWdodC54ICYmXHJcbiAgICAgIHRoaXMuYm90dG9tUmlnaHQueCA+IG90aGVyU2hhcGUudG9wTGVmdC54ICYmXHJcbiAgICAgIHRoaXMudG9wTGVmdC55IDwgb3RoZXJTaGFwZS5ib3R0b21SaWdodC55ICYmXHJcbiAgICAgIHRoaXMuYm90dG9tUmlnaHQueSA+IG90aGVyU2hhcGUudG9wUmlnaHQueVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIGNvbGxpZGVzV2l0aEFueSguLi5vdGhlclNoYXBlczogU2hhcGVbXSk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIG90aGVyU2hhcGVzLnNvbWUoKG90aGVyU2hhcGUpID0+IHRoaXMuY29sbGlkZXNXaXRoKG90aGVyU2hhcGUpKTtcclxuICB9XHJcblxyXG4gIGV4dGVuZHNCZXlvbmQob3RoZXJTaGFwZTogU2hhcGUpOiBib29sZWFuIHtcclxuICAgIHJldHVybiAoXHJcbiAgICAgIHRoaXMudG9wTGVmdC54IDwgb3RoZXJTaGFwZS50b3BMZWZ0LnggfHxcclxuICAgICAgdGhpcy5ib3R0b21SaWdodC54ID4gb3RoZXJTaGFwZS5ib3R0b21SaWdodC54IHx8XHJcbiAgICAgIHRoaXMudG9wTGVmdC55IDwgb3RoZXJTaGFwZS50b3BMZWZ0LnkgfHxcclxuICAgICAgdGhpcy5ib3R0b21SaWdodC55ID4gb3RoZXJTaGFwZS5ib3R0b21SaWdodC55XHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgZ2V0QWxsQ29sbGlzaW9uc1dpdGg8VCBleHRlbmRzIFNoYXBlPiguLi5vdGhlclNoYXBlczogVFtdKTogVFtdIHtcclxuICAgIHJldHVybiBvdGhlclNoYXBlcy5maWx0ZXIoKG90aGVyU2hhcGUpID0+IHRoaXMuY29sbGlkZXNXaXRoKG90aGVyU2hhcGUpKTtcclxuICB9XHJcblxyXG4gIGdldCB0b3BMZWZ0KCk6IElQb3NpdGlvbiB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICB4OiB0aGlzLngsXHJcbiAgICAgIHk6IHRoaXMueSxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBnZXQgdG9wUmlnaHQoKTogSVBvc2l0aW9uIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHg6IHRoaXMueCArIHRoaXMud2lkdGgsXHJcbiAgICAgIHk6IHRoaXMueSxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBnZXQgYm90dG9tTGVmdCgpOiBJUG9zaXRpb24ge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgeDogdGhpcy54LFxyXG4gICAgICB5OiB0aGlzLnkgKyB0aGlzLmhlaWdodCxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBnZXQgYm90dG9tUmlnaHQoKTogSVBvc2l0aW9uIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHg6IHRoaXMueCArIHRoaXMud2lkdGgsXHJcbiAgICAgIHk6IHRoaXMueSArIHRoaXMuaGVpZ2h0LFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIGdldCBjZW50ZXIoKTogSVBvc2l0aW9uIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHg6IHRoaXMueCArIHRoaXMud2lkdGggLyAyLFxyXG4gICAgICB5OiB0aGlzLnkgKyB0aGlzLmhlaWdodCAvIDIsXHJcbiAgICB9O1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBTaGFwZSB9IGZyb20gXCIuL3NoYXBlXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgTW92YWJsZVNoYXBlIGV4dGVuZHMgU2hhcGUge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgeDogbnVtYmVyLFxyXG4gICAgeTogbnVtYmVyLFxyXG4gICAgd2lkdGg6IG51bWJlcixcclxuICAgIGhlaWdodDogbnVtYmVyLFxyXG4gICAgcHVibGljIGRlbHRhWDogbnVtYmVyID0gMCxcclxuICAgIHB1YmxpYyBkZWx0YVk6IG51bWJlciA9IDAsXHJcbiAgICBwdWJsaWMgbW92ZW1lbnRBbW91bnQ6IG51bWJlciA9IDVcclxuICApIHtcclxuICAgIHN1cGVyKHgsIHksIHdpZHRoLCBoZWlnaHQpO1xyXG4gIH1cclxuXHJcbiAgbW92ZUJ5KGRlbHRhWDogbnVtYmVyLCBkZWx0YVk6IG51bWJlcikge1xyXG4gICAgdGhpcy54ICs9IGRlbHRhWDtcclxuICAgIHRoaXMueSArPSBkZWx0YVk7XHJcbiAgfVxyXG5cclxuICBtb3ZlKCkge1xyXG4gICAgdGhpcy54ICs9IHRoaXMuZGVsdGFYO1xyXG4gICAgdGhpcy55ICs9IHRoaXMuZGVsdGFZO1xyXG4gIH1cclxuXHJcbiAgbW92ZUJhY2soKSB7XHJcbiAgICB0aGlzLm1vdmVCeSgtdGhpcy5kZWx0YVgsIC10aGlzLmRlbHRhWSk7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IE1vdmFibGVTaGFwZSB9IGZyb20gXCIuL21vdmFibGVTaGFwZVwiO1xyXG5pbXBvcnQgeyBJUG9zaXRpb24gfSBmcm9tIFwiLi4vaW50ZXJmYWNlcy9wb3NpdGlvblwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFNob3QgZXh0ZW5kcyBNb3ZhYmxlU2hhcGUge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgZnJvbTogSVBvc2l0aW9uLFxyXG4gICAgdG86IElQb3NpdGlvbixcclxuICAgIHdpZHRoOiBudW1iZXIgPSA1LFxyXG4gICAgaGVpZ2h0OiBudW1iZXIgPSA1LFxyXG4gICAgcHVibGljIHNwZWVkOiBudW1iZXIgPSAxNSxcclxuICAgIHB1YmxpYyBkYW1hZ2U6IG51bWJlciA9IDEwXHJcbiAgKSB7XHJcbiAgICBzdXBlcihmcm9tLngsIGZyb20ueSwgd2lkdGgsIGhlaWdodCwgMCwgMCk7XHJcblxyXG4gICAgY29uc3Qgb3JpZ2luYWxEZWx0YSA9IHtcclxuICAgICAgZGVsdGFYOiB0by54IC0gZnJvbS54LCAvLyBBIGluIENBSFxyXG4gICAgICBkZWx0YVk6IHRvLnkgLSBmcm9tLnksIC8vIE8gaW4gU09IXHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IHJhZGlhbnMgPSBNYXRoLmF0YW4yKG9yaWdpbmFsRGVsdGEuZGVsdGFZLCBvcmlnaW5hbERlbHRhLmRlbHRhWCk7XHJcbiAgICB0aGlzLmRlbHRhWCA9IE1hdGguY29zKHJhZGlhbnMpICogc3BlZWQ7IC8vIENBSFxyXG4gICAgdGhpcy5kZWx0YVkgPSBNYXRoLnNpbihyYWRpYW5zKSAqIHNwZWVkOyAvLyBTT0hcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgSVBvc2l0aW9uIH0gZnJvbSBcIi4uL2ludGVyZmFjZXMvcG9zaXRpb25cIjtcclxuaW1wb3J0IHsgU2hvdCB9IGZyb20gXCIuL3Nob3RcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBTaG9vdGVyIHtcclxuICBzaG90c0ZpcmVkOiBTaG90W107XHJcbiAgY29uc3RydWN0b3IoKSB7XHJcbiAgICB0aGlzLnNob3RzRmlyZWQgPSBbXTtcclxuICB9XHJcblxyXG4gIHNob290KGZyb206IElQb3NpdGlvbiwgYXQ6IElQb3NpdGlvbikge1xyXG4gICAgY29uc3Qgc2hvdCA9IG5ldyBTaG90KGZyb20sIGF0KTtcclxuICAgIHRoaXMuc2hvdHNGaXJlZC5wdXNoKHNob3QpO1xyXG4gIH1cclxuXHJcbiAgcmVtb3ZlKHNob3RUb1JlbW92ZTogU2hvdCkge1xyXG4gICAgdGhpcy5zaG90c0ZpcmVkID0gdGhpcy5zaG90c0ZpcmVkLmZpbHRlcigoc2hvdCkgPT4gc2hvdFRvUmVtb3ZlICE9PSBzaG90KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgSGVhbHRoIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvaGVhbHRoXCI7XHJcbmltcG9ydCB7IE1vdmFibGVTaGFwZSB9IGZyb20gXCIuLi9jb21wb25lbnRzL21vdmFibGVTaGFwZVwiO1xyXG5pbXBvcnQgeyBTaG9vdGVyIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvc2hvb3RlclwiO1xyXG5pbXBvcnQgeyBQbGF5ZXIgfSBmcm9tIFwiLi4vaW50ZXJmYWNlcy9wbGF5ZXJcIjtcclxuaW1wb3J0IHsgSVBvc2l0aW9uIH0gZnJvbSBcIi4uL2ludGVyZmFjZXMvcG9zaXRpb25cIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBDb21wdXRlclBsYXllciBleHRlbmRzIE1vdmFibGVTaGFwZSBpbXBsZW1lbnRzIFBsYXllciB7XHJcbiAgI2xhc3RBY3Rpb25zOiB7XHJcbiAgICBjaGFuZ2VkRGVsdGFYOiBudW1iZXI7XHJcbiAgICBjaGFuZ2VkRGVsdGFZOiBudW1iZXI7XHJcbiAgICBzaG90OiBudW1iZXI7XHJcbiAgfTtcclxuXHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICB4OiBudW1iZXIsXHJcbiAgICB5OiBudW1iZXIsXHJcbiAgICBwdWJsaWMgaGVhbHRoOiBIZWFsdGgsXHJcbiAgICBwdWJsaWMgc2hvb3RlcjogU2hvb3RlcixcclxuICAgIHdpZHRoOiBudW1iZXIgPSAxMDAsXHJcbiAgICBoZWlnaHQ6IG51bWJlciA9IDEwMFxyXG4gICkge1xyXG4gICAgc3VwZXIoeCwgeSwgd2lkdGgsIGhlaWdodCk7XHJcblxyXG4gICAgY29uc3QgY3VycmVudFRpbWUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcclxuICAgIHRoaXMuI2xhc3RBY3Rpb25zID0ge1xyXG4gICAgICBjaGFuZ2VkRGVsdGFYOiBjdXJyZW50VGltZSxcclxuICAgICAgY2hhbmdlZERlbHRhWTogY3VycmVudFRpbWUsXHJcbiAgICAgIHNob3Q6IGN1cnJlbnRUaW1lLFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIGdldCBzaG91bGRDaGFuZ2VEaXJlY3Rpb24oKSB7XHJcbiAgICByZXR1cm4gbmV3IERhdGUoKS5nZXRUaW1lKCkgPiB0aGlzLiNsYXN0QWN0aW9ucy5jaGFuZ2VkRGVsdGFYICsgMTAwO1xyXG4gIH1cclxuXHJcbiAgZ2V0IHNob3VsZFNob290KCkge1xyXG4gICAgcmV0dXJuIG5ldyBEYXRlKCkuZ2V0VGltZSgpID4gdGhpcy4jbGFzdEFjdGlvbnMuc2hvdCArIDIwMDA7XHJcbiAgfVxyXG5cclxuICBtYXliZUNoYW5nZURpcmVjdGlvbigpIHtcclxuICAgIGlmICh0aGlzLnNob3VsZENoYW5nZURpcmVjdGlvbikge1xyXG4gICAgICBjb25zdCBsZWZ0T3JSaWdodCA9IE1hdGgucmFuZG9tKCkgPCAwLjUgPyAtMSA6IDE7XHJcbiAgICAgIHRoaXMuZGVsdGFYID0gTWF0aC5yYW5kb20oKSAqIDUgKiBsZWZ0T3JSaWdodDtcclxuXHJcbiAgICAgIGNvbnN0IHVwT3JEb3duID0gTWF0aC5yYW5kb20oKSA8IDAuNSA/IC0xIDogMTtcclxuICAgICAgdGhpcy5kZWx0YVkgPSBNYXRoLnJhbmRvbSgpICogNSAqIHVwT3JEb3duO1xyXG5cclxuICAgICAgY29uc3QgY3VycmVudFRpbWUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcclxuICAgICAgdGhpcy4jbGFzdEFjdGlvbnMuY2hhbmdlZERlbHRhWCA9IGN1cnJlbnRUaW1lO1xyXG4gICAgICB0aGlzLiNsYXN0QWN0aW9ucy5jaGFuZ2VkRGVsdGFZID0gY3VycmVudFRpbWU7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBtb3ZlKCkge1xyXG4gICAgdGhpcy5tYXliZUNoYW5nZURpcmVjdGlvbigpO1xyXG4gICAgc3VwZXIubW92ZSgpO1xyXG4gIH1cclxuXHJcbiAgc2hvb3QoYXQ6IElQb3NpdGlvbikge1xyXG4gICAgaWYgKHRoaXMuc2hvdWxkU2hvb3QpIHtcclxuICAgICAgdGhpcy5zaG9vdGVyLnNob290KFxyXG4gICAgICAgIHtcclxuICAgICAgICAgIHg6IHRoaXMuY2VudGVyLngsXHJcbiAgICAgICAgICB5OiB0aGlzLmNlbnRlci55LFxyXG4gICAgICAgIH0sXHJcbiAgICAgICAge1xyXG4gICAgICAgICAgeDogYXQueCxcclxuICAgICAgICAgIHk6IGF0LnksXHJcbiAgICAgICAgfVxyXG4gICAgICApO1xyXG4gICAgfVxyXG4gIH1cclxufVxyXG5cclxuZnVuY3Rpb24gY3JlYXRlRGVmYXVsdENvbXB1dGVyUGxheWVyKCkge1xyXG4gIGNvbnN0IGhlYWx0aCA9IG5ldyBIZWFsdGgoMTAwKTtcclxuICBjb25zdCBzaG9vdGVyID0gbmV3IFNob290ZXIoKTtcclxuICByZXR1cm4gbmV3IENvbXB1dGVyUGxheWVyKDYwMCwgMjAwLCBoZWFsdGgsIHNob290ZXIpO1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgZGVmYXVsdENvbXB1dGVyUGxheWVyID0gY3JlYXRlRGVmYXVsdENvbXB1dGVyUGxheWVyKCk7XHJcbiIsImludGVyZmFjZSBDb250cm9sTWFwIHtcclxuICBbY29udHJvbDogc3RyaW5nXTogYm9vbGVhbjtcclxufVxyXG5cclxudHlwZSBpbnB1dEhhbmRsZXIgPSAoXHJcbiAgaW5wdXQ6IHN0cmluZyxcclxuICBuZXdTdGF0ZTogYm9vbGVhbixcclxuICBlOiBNb3VzZUV2ZW50IHwgS2V5Ym9hcmRFdmVudFxyXG4pID0+IHZvaWQ7XHJcblxyXG5leHBvcnQgY2xhc3MgQ29udHJvbHMge1xyXG4gIGlucHV0czogQ29udHJvbE1hcDtcclxuICAjb25JbnB1dDogaW5wdXRIYW5kbGVyO1xyXG5cclxuICBjb25zdHJ1Y3RvcihjYW52YXM6IEhUTUxDYW52YXNFbGVtZW50LCB3aW5kb3c6IFdpbmRvdykge1xyXG4gICAgLy8gTWlnaHQgYmUgd29ydGggc2V0dGluZyB0aGlzIG9iamVjdCB1cCBhcyBhIHByb3h5P1xyXG4gICAgdGhpcy5pbnB1dHMgPSB7XHJcbiAgICAgIEtleVc6IGZhbHNlLFxyXG4gICAgICBLZXlBOiBmYWxzZSxcclxuICAgICAgS2V5UzogZmFsc2UsXHJcbiAgICAgIEtleUQ6IGZhbHNlLFxyXG4gICAgICBMTUI6IGZhbHNlLFxyXG4gICAgfTtcclxuICAgIHRoaXMuI29uSW5wdXQgPSAoaW5wdXQsIG5ld1ZhbHVlKSA9PiBjb25zb2xlLmxvZyh7IGlucHV0LCBuZXdWYWx1ZSB9KTtcclxuXHJcbiAgICBjb25zdCBjbGlja0xpc3RlbmVyID0gKGU6IE1vdXNlRXZlbnQpID0+IHtcclxuICAgICAgaWYgKDAgPT09IGUuYnV0dG9uKSB7XHJcbiAgICAgICAgdGhpcy5pbnB1dHMuTE1CID0gZS50eXBlID09PSBcIm1vdXNlZG93blwiO1xyXG4gICAgICAgIHRoaXMuI29uSW5wdXQoXCJMTUJcIiwgdGhpcy5pbnB1dHMuTE1CLCBlKTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBjb25zdCBrZXlMaXN0ZW5lciA9IChlOiBLZXlib2FyZEV2ZW50KSA9PiB7XHJcbiAgICAgIGNvbnN0IHsgY29kZSB9ID0gZTtcclxuICAgICAgaWYgKHRoaXMuaW5wdXRzLmhhc093blByb3BlcnR5KGNvZGUpKSB7XHJcbiAgICAgICAgdGhpcy5pbnB1dHNbY29kZV0gPSBlLnR5cGUgPT09IFwia2V5ZG93blwiO1xyXG4gICAgICAgIHRoaXMuI29uSW5wdXQoY29kZSwgdGhpcy5pbnB1dHNbY29kZV0sIGUpO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG5cclxuICAgIGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwibW91c2V1cFwiLCBjbGlja0xpc3RlbmVyKTtcclxuICAgIGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwibW91c2Vkb3duXCIsIGNsaWNrTGlzdGVuZXIpO1xyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXl1cFwiLCBrZXlMaXN0ZW5lcik7XHJcbiAgICB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwga2V5TGlzdGVuZXIpO1xyXG4gIH1cclxuXHJcbiAgc2V0IG9uSW5wdXRIYW5kbGVyKG5ld0hhbmRsZXI6IGlucHV0SGFuZGxlcikge1xyXG4gICAgdGhpcy4jb25JbnB1dCA9IG5ld0hhbmRsZXI7XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IENvbnRyb2xzIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvY29udHJvbHNcIjtcclxuaW1wb3J0IHsgSGVhbHRoIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvaGVhbHRoXCI7XHJcbmltcG9ydCB7IE1vdmFibGVTaGFwZSB9IGZyb20gXCIuLi9jb21wb25lbnRzL21vdmFibGVTaGFwZVwiO1xyXG5pbXBvcnQgeyBTaG9vdGVyIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvc2hvb3RlclwiO1xyXG5pbXBvcnQgeyBQbGF5ZXIgfSBmcm9tIFwiLi4vaW50ZXJmYWNlcy9wbGF5ZXJcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBIdW1hblBsYXllciBleHRlbmRzIE1vdmFibGVTaGFwZSBpbXBsZW1lbnRzIFBsYXllciB7XHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICB4OiBudW1iZXIsXHJcbiAgICB5OiBudW1iZXIsXHJcbiAgICBwdWJsaWMgaGVhbHRoOiBIZWFsdGgsXHJcbiAgICBwdWJsaWMgY29udHJvbHM6IENvbnRyb2xzLFxyXG4gICAgcHVibGljIHNob290ZXI6IFNob290ZXIsXHJcbiAgICB3aWR0aDogbnVtYmVyID0gMTAwLFxyXG4gICAgaGVpZ2h0OiBudW1iZXIgPSAxMDAsXHJcbiAgICBkZWx0YVg6IG51bWJlciA9IDAsXHJcbiAgICBkZWx0YVk6IG51bWJlciA9IDBcclxuICApIHtcclxuICAgIHN1cGVyKHgsIHksIHdpZHRoLCBoZWlnaHQsIGRlbHRhWCwgZGVsdGFZKTtcclxuICAgIHRoaXMuY29udHJvbHMub25JbnB1dEhhbmRsZXIgPSAoaW5wdXQsIG5ld1N0YXRlLCBldmVudCkgPT4ge1xyXG4gICAgICBpZiAoXCJMTUJcIiA9PT0gaW5wdXQgJiYgbmV3U3RhdGUpIHtcclxuICAgICAgICB0aGlzLnNob290ZXIuc2hvb3QoXHJcbiAgICAgICAgICB7IHg6IHRoaXMuY2VudGVyLngsIHk6IHRoaXMuY2VudGVyLnkgfSxcclxuICAgICAgICAgIHsgeDogKGV2ZW50IGFzIE1vdXNlRXZlbnQpLngsIHk6IChldmVudCBhcyBNb3VzZUV2ZW50KS55IH1cclxuICAgICAgICApO1xyXG4gICAgICB9XHJcbiAgICB9O1xyXG4gICAgdGhpcy5tb3ZlbWVudEFtb3VudCA9IDU7XHJcbiAgfVxyXG5cclxuICBtb3ZlKCkge1xyXG4gICAgaWYgKHRoaXMuY29udHJvbHMuaW5wdXRzLktleVcpIHtcclxuICAgICAgdGhpcy5kZWx0YVkgPSAtdGhpcy5tb3ZlbWVudEFtb3VudDtcclxuICAgIH0gZWxzZSBpZiAodGhpcy5jb250cm9scy5pbnB1dHMuS2V5Uykge1xyXG4gICAgICB0aGlzLmRlbHRhWSA9IHRoaXMubW92ZW1lbnRBbW91bnQ7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLmRlbHRhWSA9IDA7XHJcbiAgICB9XHJcblxyXG4gICAgaWYgKHRoaXMuY29udHJvbHMuaW5wdXRzLktleUEpIHtcclxuICAgICAgdGhpcy5kZWx0YVggPSAtdGhpcy5tb3ZlbWVudEFtb3VudDtcclxuICAgIH0gZWxzZSBpZiAodGhpcy5jb250cm9scy5pbnB1dHMuS2V5RCkge1xyXG4gICAgICB0aGlzLmRlbHRhWCA9IHRoaXMubW92ZW1lbnRBbW91bnQ7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLmRlbHRhWCA9IDA7XHJcbiAgICB9XHJcbiAgICBzdXBlci5tb3ZlKCk7XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiBjcmVhdGVEZWZhdWx0SHVtYW5QbGF5ZXIoKSB7XHJcbiAgY29uc3QgaGVhbHRoID0gbmV3IEhlYWx0aCgxMDApO1xyXG4gIGNvbnN0IGNvbnRyb2xzID0gbmV3IENvbnRyb2xzKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCJjYW52YXNcIikhLCB3aW5kb3cpO1xyXG4gIGNvbnN0IHNob290ZXIgPSBuZXcgU2hvb3RlcigpO1xyXG4gIHJldHVybiBuZXcgSHVtYW5QbGF5ZXIoMzAwLCAxMDAsIGhlYWx0aCwgY29udHJvbHMsIHNob290ZXIpO1xyXG59XHJcblxyXG5leHBvcnQgY29uc3QgZGVmYXVsdEh1bWFuUGxheWVyID0gY3JlYXRlRGVmYXVsdEh1bWFuUGxheWVyKCk7XHJcbiIsImltcG9ydCB7IEhlYWx0aCB9IGZyb20gXCIuLi9jb21wb25lbnRzL2hlYWx0aFwiO1xyXG5pbXBvcnQgeyBTaGFwZSB9IGZyb20gXCIuLi9jb21wb25lbnRzL3NoYXBlXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgT2JzdGFjbGUgZXh0ZW5kcyBTaGFwZSB7XHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICB4OiBudW1iZXIsXHJcbiAgICB5OiBudW1iZXIsXHJcbiAgICB3aWR0aDogbnVtYmVyLFxyXG4gICAgaGVpZ2h0OiBudW1iZXIsXHJcbiAgICBwdWJsaWMgaGVhbHRoOiBIZWFsdGhcclxuICApIHtcclxuICAgIHN1cGVyKHgsIHksIHdpZHRoLCBoZWlnaHQpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBkZWZhdWx0Q29tcHV0ZXJQbGF5ZXIgfSBmcm9tIFwiLi9tb2RlbC9jbGFzc2VzL2NvbXB1dGVyUGxheWVyXCI7XHJcbmltcG9ydCB7IGRlZmF1bHRIdW1hblBsYXllciB9IGZyb20gXCIuL21vZGVsL2NsYXNzZXMvaHVtYW5QbGF5ZXJcIjtcclxuaW1wb3J0IHsgT2JzdGFjbGUgfSBmcm9tIFwiLi9tb2RlbC9jbGFzc2VzL29ic3RhY2xlXCI7XHJcbmltcG9ydCB7IFdvcmxkIH0gZnJvbSBcIi4vbW9kZWwvY2xhc3Nlcy93b3JsZFwiO1xyXG5pbXBvcnQgeyBIZWFsdGggfSBmcm9tIFwiLi9tb2RlbC9jb21wb25lbnRzL2hlYWx0aFwiO1xyXG5pbXBvcnQgeyBQbGF5ZXIgfSBmcm9tIFwiLi9tb2RlbC9pbnRlcmZhY2VzL3BsYXllclwiO1xyXG5cclxuY29uc3QgcGxheWVyczogUGxheWVyW10gPSBbZGVmYXVsdEh1bWFuUGxheWVyLCBkZWZhdWx0Q29tcHV0ZXJQbGF5ZXJdO1xyXG5cclxuY29uc3Qgb2JzdGFjbGVzID0gW1xyXG4gIG5ldyBPYnN0YWNsZSgyMDAsIDIwMCwgNTAsIDUwLCBuZXcgSGVhbHRoKDIwMCkpLFxyXG4gIG5ldyBPYnN0YWNsZSgzMDAsIDMwMCwgMjAsIDE1MCwgbmV3IEhlYWx0aCgyMDApKSxcclxuICBuZXcgT2JzdGFjbGUoNjAwLCA0MDAsIDkwLCA3MCwgbmV3IEhlYWx0aCgyMDApKSxcclxuXTtcclxuXHJcbmNvbnN0IHdvcmxkID0gbmV3IFdvcmxkKCk7XHJcblxyXG5leHBvcnQgY29uc3QgZGVmYXVsdENvbmZpZyA9IHtcclxuICBwbGF5ZXJzLFxyXG4gIG9ic3RhY2xlcyxcclxuICB3b3JsZCxcclxufTtcclxuIiwiaW1wb3J0IHsgU2hhcGUgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9zaGFwZVwiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFdvcmxkIGV4dGVuZHMgU2hhcGUge1xyXG4gIGNvbnN0cnVjdG9yKHdpZHRoOiBudW1iZXIgPSA4MDAsIGhlaWdodDogbnVtYmVyID0gNTAwKSB7XHJcbiAgICBzdXBlcigwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgZGVmYXVsdENvbmZpZyB9IGZyb20gXCIuL2RlZmF1bHRHYW1lXCI7XHJcbmltcG9ydCB7IEdhbWUgfSBmcm9tIFwiLi9tb2RlbC9jbGFzc2VzL2dhbWVcIjtcclxuXHJcbmNvbnN0IHsgd29ybGQsIHBsYXllcnMsIG9ic3RhY2xlcyB9ID0gZGVmYXVsdENvbmZpZztcclxuY29uc3QgY2FudmFzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImNhbnZhc1wiKSE7XHJcblxyXG5jb25zdCBnYW1lID0gbmV3IEdhbWUod29ybGQsIHBsYXllcnMsIG9ic3RhY2xlcywgY2FudmFzKTtcclxuZ2FtZS5wbGF5KCk7XHJcblxyXG4vLyBPYmplY3QuYXNzaWduKHdpbmRvdywgeyBnYW1lIH0pO1xyXG4iLCJpbXBvcnQgeyBQbGF5ZXIgfSBmcm9tIFwiLi4vaW50ZXJmYWNlcy9wbGF5ZXJcIjtcclxuaW1wb3J0IHsgT2JzdGFjbGUgfSBmcm9tIFwiLi9vYnN0YWNsZVwiO1xyXG5pbXBvcnQgeyBXb3JsZCB9IGZyb20gXCIuL3dvcmxkXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgR2FtZSB7XHJcbiAgI2N0eDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEO1xyXG4gICNpc1J1bm5pbmc6IGJvb2xlYW47XHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHJpdmF0ZSB3b3JsZDogV29ybGQsXHJcbiAgICBwcml2YXRlIHBsYXllcnM6IFBsYXllcltdLFxyXG4gICAgcHJpdmF0ZSBvYnN0YWNsZXM6IE9ic3RhY2xlW10sXHJcbiAgICBwcml2YXRlIGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnRcclxuICApIHtcclxuICAgIHRoaXMuY2FudmFzLmhlaWdodCA9IHRoaXMud29ybGQuaGVpZ2h0O1xyXG4gICAgdGhpcy5jYW52YXMud2lkdGggPSB0aGlzLndvcmxkLndpZHRoO1xyXG4gICAgdGhpcy4jY3R4ID0gdGhpcy5jYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpITtcclxuICAgIHRoaXMuI2lzUnVubmluZyA9IGZhbHNlO1xyXG4gIH1cclxuXHJcbiAgb3RoZXJQbGF5ZXJzKHBsYXllclRvRXhjbHVkZTogUGxheWVyKSB7XHJcbiAgICByZXR1cm4gdGhpcy5wbGF5ZXJzLmZpbHRlcigocGxheWVyKSA9PiBwbGF5ZXIgIT09IHBsYXllclRvRXhjbHVkZSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBUT0RPOiBQdXQgXCJkcmF3XCIvXCJyZW5kZXJcIiBtZXRob2Qgb24gXCJTaGFwZVwiIGNsYXNzXHJcbiAgICogYW5kIGhhdmUgYWxsIHN1YmNsYXNzZXMgKFNob3QsIE1vdmFibGVTaGFwZSwgSHVtYW5QbGF5ZXIsXHJcbiAgICogQ29tcHV0ZXJQbGF5ZXIpIG92ZXJyaWRlIHdpdGggdGhlaXIgaW1wbGVtZW50YXRpb25cclxuICAgKiAoZGVwZW5kaW5nIG9uIGhvdyB0aGV5IHdhbnQgdG8gYmUgcmVuZGVyZWQgb24gdGhlIGNhbnZhcykuXHJcbiAgICogVGhlbiB0aGUgY2FsbGVyIGNhbiBqdXN0IGNhbGwgXCJkcmF3XCIgbWV0aG9kIGFuZCB0aGUgY2xhc3Nlc1xyXG4gICAqIHRoZW1zZWx2ZXMgY2FuIGJlIHJlc3BvbnNpYmxlIGZvciBob3cgdGhleSdyZSByZXByZXNlbnRlZC5cclxuICAgKi9cclxuICBwbGF5KCkge1xyXG4gICAgdGhpcy4jY3R4LmNsZWFyUmVjdCgwLCAwLCB0aGlzLmNhbnZhcy53aWR0aCwgdGhpcy5jYW52YXMuaGVpZ2h0KTtcclxuXHJcbiAgICBmb3IgKGNvbnN0IHBsYXllciBvZiB0aGlzLnBsYXllcnMpIHtcclxuICAgICAgcGxheWVyLm1vdmUoKTtcclxuXHJcbiAgICAgIC8vIFRPRE86IHRoaXMgaXMgcXVhZHJhdGljIGJlaGF2aW91ciAoYW5kIHdpbGwgc2NhbGUgcG9vcmx5KSwgYnV0IG1pZ2h0IG5vdCBoYXZlIGVub3VnaFxyXG4gICAgICAvLyBvYmplY3RzL2NvbXBhcmlzb25zIHRvIHdhcnJhbnQgYSBtb3JlIGVmZmljaWVudCBzdHJ1Y3R1cmVcclxuICAgICAgLy8gZS5nIHF1YWR0cmVlLCBvY3RvdHJlZS5cclxuICAgICAgaWYgKFxyXG4gICAgICAgIHBsYXllci5leHRlbmRzQmV5b25kKHRoaXMud29ybGQpIHx8XHJcbiAgICAgICAgcGxheWVyLmNvbGxpZGVzV2l0aEFueSguLi50aGlzLm90aGVyUGxheWVycyhwbGF5ZXIpKSB8fFxyXG4gICAgICAgIHBsYXllci5jb2xsaWRlc1dpdGhBbnkoLi4udGhpcy5vYnN0YWNsZXMpXHJcbiAgICAgICkge1xyXG4gICAgICAgIHBsYXllci5tb3ZlQmFjaygpO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBQbGF5ZXIgc3ByaXRlXHJcbiAgICAgIHRoaXMuI2N0eC5maWxsU3R5bGUgPSBcInJlZFwiO1xyXG4gICAgICB0aGlzLiNjdHguZmlsbFJlY3QocGxheWVyLngsIHBsYXllci55LCBwbGF5ZXIud2lkdGgsIHBsYXllci5oZWlnaHQpO1xyXG5cclxuICAgICAgLy8gUGxheWVyIEhQIGJhclxyXG4gICAgICB0aGlzLiNjdHguZmlsbFN0eWxlID0gcGxheWVyLmhlYWx0aC5jdXJyZW50Q29sb3VyO1xyXG4gICAgICB0aGlzLiNjdHguZmlsbFJlY3QoXHJcbiAgICAgICAgcGxheWVyLngsXHJcbiAgICAgICAgcGxheWVyLnkgLSA0MCxcclxuICAgICAgICBwbGF5ZXIuaGVhbHRoLmN1cnJlbnRQZXJjZW50YWdlICogcGxheWVyLndpZHRoLFxyXG4gICAgICAgIDIwXHJcbiAgICAgICk7XHJcbiAgICAgIHRoaXMuI2N0eC5zdHJva2VTdHlsZSA9IFwiYmxhY2tcIjtcclxuICAgICAgdGhpcy4jY3R4LmxpbmVXaWR0aCA9IDI7XHJcbiAgICAgIHRoaXMuI2N0eC5zdHJva2VSZWN0KHBsYXllci54LCBwbGF5ZXIueSAtIDQwLCBwbGF5ZXIud2lkdGgsIDIwKTtcclxuXHJcbiAgICAgIC8vIFVwZGF0ZVxyXG4gICAgICBmb3IgKGNvbnN0IHNob3Qgb2YgcGxheWVyLnNob290ZXIuc2hvdHNGaXJlZCkge1xyXG4gICAgICAgIHNob3QubW92ZSgpO1xyXG5cclxuICAgICAgICAvLyBIYXMgc2hvdCBsZWZ0IHRoZSB3b3JsZC92aWV3IHNjb3BlXHJcbiAgICAgICAgaWYgKHNob3QuZXh0ZW5kc0JleW9uZCh0aGlzLndvcmxkKSkge1xyXG4gICAgICAgICAgLy8gVE9ETzogSXNuJ3QgdGhpcyBwcm9ibGVtYXRpYz8gU2hvdWxkbid0IHJlbW92ZSBlbGVtZW50cyBmcm9tIHdoYXRcclxuICAgICAgICAgIC8vIHdlJ3JlIGl0ZXJhdGluZyBvdmVyLlxyXG4gICAgICAgICAgcGxheWVyLnNob290ZXIucmVtb3ZlKHNob3QpO1xyXG4gICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBEb2VzIHNob3QgY29sbGlkZSB3aXRoIGFueSBvYnN0YWNsZXM/XHJcbiAgICAgICAgY29uc3Qgb2JzdGFjbGVzU2hvdCA9IHNob3QuZ2V0QWxsQ29sbGlzaW9uc1dpdGgoLi4udGhpcy5vYnN0YWNsZXMpO1xyXG4gICAgICAgIG9ic3RhY2xlc1Nob3QuZm9yRWFjaCgob2JzdGFjbGUpID0+XHJcbiAgICAgICAgICBvYnN0YWNsZS5oZWFsdGguY2hhbmdlSGVhbHRoQnkoLXNob3QuZGFtYWdlKVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIC8vIERvZXMgc2hvdCBjb2xsaWRlIHdpdGggYW55IHBsYXllcnM/XHJcbiAgICAgICAgY29uc3QgcGxheWVyc1Nob3QgPSBzaG90LmdldEFsbENvbGxpc2lvbnNXaXRoKFxyXG4gICAgICAgICAgLi4udGhpcy5vdGhlclBsYXllcnMocGxheWVyKVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgZm9yIChjb25zdCBwbGF5ZXIgb2YgcGxheWVyc1Nob3QpIHtcclxuICAgICAgICAgIHBsYXllci5oZWFsdGguY2hhbmdlSGVhbHRoQnkoLXNob3QuZGFtYWdlKTtcclxuICAgICAgICAgIGlmIChwbGF5ZXIuaGVhbHRoLmlzRW1wdHkpIHtcclxuICAgICAgICAgICAgdGhpcy4jaXNSdW5uaW5nID0gZmFsc2U7XHJcbiAgICAgICAgICAgIHJldHVybiBhbGVydChgJHtwbGF5ZXJ9IGxvc3QhYCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAob2JzdGFjbGVzU2hvdC5sZW5ndGggPiAwIHx8IHBsYXllcnNTaG90Lmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgIC8vIFRPRE86IElzbid0IHRoaXMgcHJvYmxlbWF0aWM/IFNob3VsZG4ndCByZW1vdmUgZWxlbWVudHMgZnJvbSB3aGF0XHJcbiAgICAgICAgICAvLyB3ZSdyZSBpdGVyYXRpbmcgb3Zlci5cclxuICAgICAgICAgIHBsYXllci5zaG9vdGVyLnJlbW92ZShzaG90KTtcclxuICAgICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgdGhpcy4jY3R4LmZpbGxTdHlsZSA9IFwiZ29sZGVucm9kXCI7XHJcbiAgICAgICAgdGhpcy4jY3R4LmZpbGxSZWN0KHNob3QueCwgc2hvdC55LCA3LCA3KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgZm9yIChjb25zdCBvYnN0YWNsZSBvZiB0aGlzLm9ic3RhY2xlcykge1xyXG4gICAgICAgIC8vIE9ic3RhY2xlXHJcbiAgICAgICAgdGhpcy4jY3R4LmZpbGxTdHlsZSA9IFwiIzcwNDMwMFwiO1xyXG4gICAgICAgIHRoaXMuI2N0eC5maWxsUmVjdChcclxuICAgICAgICAgIG9ic3RhY2xlLngsXHJcbiAgICAgICAgICBvYnN0YWNsZS55LFxyXG4gICAgICAgICAgb2JzdGFjbGUud2lkdGgsXHJcbiAgICAgICAgICBvYnN0YWNsZS5oZWlnaHRcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICAvLyBPYnN0YWNsZSBIUCBiYXJcclxuICAgICAgICB0aGlzLiNjdHguZmlsbFN0eWxlID0gb2JzdGFjbGUuaGVhbHRoLmN1cnJlbnRDb2xvdXI7XHJcbiAgICAgICAgdGhpcy4jY3R4LmZpbGxSZWN0KFxyXG4gICAgICAgICAgb2JzdGFjbGUueCxcclxuICAgICAgICAgIG9ic3RhY2xlLnkgLSA0MCxcclxuICAgICAgICAgIG9ic3RhY2xlLmhlYWx0aC5jdXJyZW50UGVyY2VudGFnZSAqIG9ic3RhY2xlLndpZHRoLFxyXG4gICAgICAgICAgMjBcclxuICAgICAgICApO1xyXG4gICAgICAgIHRoaXMuI2N0eC5zdHJva2VTdHlsZSA9IFwiYmxhY2tcIjtcclxuICAgICAgICB0aGlzLiNjdHgubGluZVdpZHRoID0gMjtcclxuICAgICAgICB0aGlzLiNjdHguc3Ryb2tlUmVjdChvYnN0YWNsZS54LCBvYnN0YWNsZS55IC0gNDAsIG9ic3RhY2xlLndpZHRoLCAyMCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5wbGF5LmJpbmQodGhpcykpO1xyXG4gIH1cclxufVxyXG4iXSwic291cmNlUm9vdCI6IiJ9