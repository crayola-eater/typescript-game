(()=>{"use strict";class t{constructor(t,e,s,i){this.x=t,this.y=e,this.width=s,this.height=i}collidesWith(t){return this.topLeft.x<t.bottomRight.x&&this.bottomRight.x>t.topLeft.x&&this.topLeft.y<t.bottomRight.y&&this.bottomRight.y>t.topRight.y}collidesWithAny(...t){return t.some((t=>this.collidesWith(t)))}extendsBeyond(t){return this.topLeft.x<t.topLeft.x||this.bottomRight.x>t.bottomRight.x||this.topLeft.y<t.topLeft.y||this.bottomRight.y>t.bottomRight.y}getAllCollisionsWith(...t){return t.filter((t=>this.collidesWith(t)))}get topLeft(){return{x:this.x,y:this.y}}get topRight(){return{x:this.x+this.width,y:this.y}}get bottomLeft(){return{x:this.x,y:this.y+this.height}}get bottomRight(){return{x:this.x+this.width,y:this.y+this.height}}get center(){return{x:this.x+this.width/2,y:this.y+this.height/2}}}class e extends t{constructor(t,e,s,i,h=0,o=0,n=5){super(t,e,s,i),this.deltaX=h,this.deltaY=o,this.movementAmount=n}moveBy(t,e){this.x+=t,this.y+=e}move(){this.x+=this.deltaX,this.y+=this.deltaY}moveBack(){this.moveBy(-this.deltaX,-this.deltaY)}}class s extends e{constructor(t,e,s,i,h,o=100,n=100,r=0,a=0){super(e,s,o,n,r,a),this.details=t,this.health=i,this.shooter=h}shoot(t){this.shooter.shoot({x:this.center.x,y:this.center.y},{x:t.x,y:t.y})}draw(t){t.fillStyle=this.details.colour,t.fillRect(this.x,this.y,this.width,this.height),t.fillStyle=this.health.currentColour,t.fillRect(this.x,this.y-40,this.health.currentPercentage*this.width,20),t.strokeStyle="black",t.lineWidth=2,t.strokeRect(this.x,this.y-40,this.width,20),t.fillStyle="black",t.fillText(this.details.name,this.x,this.y-50)}}var i,h=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)};class o extends s{constructor(t,e,s,h,o,n=100,r=100){super(t,e,s,h,o,n,r),this.details=t,this.health=h,this.shooter=o,i.set(this,void 0);const a=(new Date).getTime();!function(t,e,s){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");e.set(t,s)}(this,i,{changedDeltaX:a,changedDeltaY:a,shot:a})}get shouldChangeDirection(){return(new Date).getTime()>h(this,i).changedDeltaX+100}get shouldShoot(){return(new Date).getTime()>h(this,i).shot+500}maybeChangeDirection(){if(this.shouldChangeDirection){const t=Math.random()<.5?-1:1;this.deltaX=5*Math.random()*t;const e=Math.random()<.5?-1:1;this.deltaY=5*Math.random()*e;const s=(new Date).getTime();h(this,i).changedDeltaX=s,h(this,i).changedDeltaY=s}}move(){this.maybeChangeDirection(),super.move()}shoot(t){this.shouldShoot&&(h(this,i).shot=(new Date).getTime(),super.shoot(t))}}i=new WeakMap;class n extends t{constructor(t,e,s,i,h){super(t,e,s,i),this.health=h}draw(t){t.fillStyle="#704300",t.fillRect(this.x,this.y,this.width,this.height),t.fillStyle=this.health.currentColour,t.fillRect(this.x,this.y-40,this.health.currentPercentage*this.width,20),t.strokeStyle="black",t.lineWidth=2,t.strokeRect(this.x,this.y-40,this.width,20)}}class r{constructor(t,e=t){this.maxHealth=t,this.currentHealth=e}changeHealthBy(t){this.currentHealth=Math.max(0,this.currentHealth+t)}get isEmpty(){return 0===this.currentHealth}get currentPercentage(){return this.currentHealth/this.maxHealth}get currentColour(){return this.currentPercentage>.6?"green":this.currentPercentage>.4?"yellow":"red"}}class a extends e{constructor(t,e,s=5,i=5,h=15,o=10){super(t.x,t.y,s,i,0,0),this.speed=h,this.damage=o;const n={deltaX:e.x-t.x,deltaY:e.y-t.y},r=Math.atan2(n.deltaY,n.deltaX);this.deltaX=Math.cos(r)*h,this.deltaY=Math.sin(r)*h}draw(t){t.fillStyle="goldenrod",t.fillRect(this.x,this.y,7,7)}}class l{constructor(){this.shotsFired=[]}shoot(t,e){const s=new a(t,e);this.shotsFired.push(s)}remove(t){this.shotsFired=this.shotsFired.filter((e=>e!==t))}removeShots(...t){this.shotsFired=this.shotsFired.filter((e=>!t.includes(e)))}keepShotsWhere(t){this.shotsFired=this.shotsFired.filter(t)}}var c,d=function(t,e,s){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");return e.set(t,s),s},u=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)};c=new WeakMap;const y=new o({name:"big_guy1954 (🖥️)",colour:"purple"},300,300,new r(400),new l),p=new o({name:"strangeOne45 (🖥️)",colour:"red"},300,50,new r(50),new l,20,20),m=new o({name:"0101010101 (🖥️)",colour:"navy"},400,200,new r(100),new l),w={players:[new class extends s{constructor(t,e,s,i,h,o,n=100,r=100,a=0,l=0){super(t,e,s,i,o,n,r,a,l),this.details=t,this.health=i,this.controls=h,this.shooter=o,this.controls.onInputHandler=(t,e,s)=>{"LMB"===t&&e&&super.shoot({x:s.offsetX,y:s.offsetY})},this.movementAmount=5}move(){this.controls.inputs.KeyW?this.deltaY=-this.movementAmount:this.controls.inputs.KeyS?this.deltaY=this.movementAmount:this.deltaY=0,this.controls.inputs.KeyA?this.deltaX=-this.movementAmount:this.controls.inputs.KeyD?this.deltaX=this.movementAmount:this.deltaX=0,super.move()}}({name:"You (🎮)",colour:"olive"},0,400,new r(200),new class{constructor(t,e){c.set(this,void 0),this.inputs={KeyW:!1,KeyA:!1,KeyS:!1,KeyD:!1,LMB:!1},d(this,c,((t,e)=>console.log({input:t,newValue:e})));const s=t=>{0===t.button&&(this.inputs.LMB="mousedown"===t.type,u(this,c).call(this,"LMB",this.inputs.LMB,t))},i=t=>{const{code:e}=t;this.inputs.hasOwnProperty(e)&&(this.inputs[e]="keydown"===t.type,u(this,c).call(this,e,this.inputs[e],t))};t.addEventListener("mouseup",s),t.addEventListener("mousedown",s),e.addEventListener("keyup",i),e.addEventListener("keydown",i)}set onInputHandler(t){d(this,c,t)}}(document.querySelector("canvas"),window),new l),y,p,m],obstacles:[new n(200,200,50,50,new r(300)),new n(100,300,20,150,new r(300)),new n(600,400,90,70,new r(300))],world:new class extends t{constructor(t,e){super(0,0,t,e)}draw(){}}(700,500)};var g,f=function(t,e){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)};g=new WeakMap;const{world:x,players:v,obstacles:b}=w,W=document.querySelector("canvas");new class{constructor(t,e,s,i){this.world=t,this.players=e,this.obstacles=s,this.canvas=i,g.set(this,void 0),this.canvas.height=this.world.height,this.canvas.width=this.world.width,function(t,e,s){if(!e.has(t))throw new TypeError("attempted to set private field on non-instance");e.set(t,s)}(this,g,this.canvas.getContext("2d"))}get computerPlayers(){return this.players.filter((t=>t instanceof o))}otherPlayers(t){return this.players.filter((e=>e!==t))}updatePositions(){for(const t of this.computerPlayers){const e=this.players.find((e=>e!==t));t.shoot({x:e.center.x,y:e.center.y})}this.players=this.players.filter((t=>!t.health.isEmpty));for(const t of this.players){t.move(),(t.extendsBeyond(this.world)||t.collidesWithAny(...this.otherPlayers(t))||t.collidesWithAny(...this.obstacles))&&t.moveBack();for(const e of t.shooter.shotsFired)e.move();this.processCollisions()}}processCollisions(){for(const t of this.players)t.shooter.keepShotsWhere((e=>{const s=e.getAllCollisionsWith(...this.obstacles);s.forEach((t=>t.health.changeHealthBy(-e.damage)));const i=e.getAllCollisionsWith(...this.otherPlayers(t));return i.forEach((t=>t.health.changeHealthBy(-e.damage))),0===s.length&&0===i.length&&!e.extendsBeyond(this.world)}));this.obstacles=this.obstacles.filter((t=>!t.health.isEmpty))}draw(){f(this,g).clearRect(0,0,this.canvas.width,this.canvas.height);for(const t of this.players){t.draw(f(this,g));for(const e of t.shooter.shotsFired)e.draw(f(this,g));for(const t of this.obstacles)t.draw(f(this,g))}}getWinnerOrNull(){const t=this.players.filter((t=>!t.health.isEmpty));return 1===t.length?t[0]:null}play(){this.updatePositions(),this.draw();const t=this.getWinnerOrNull();t?setTimeout((()=>alert(t.details.name+" won!")),10):requestAnimationFrame(this.play.bind(this))}}(x,v,b,W).play()})();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9zbWFsbC1nYW1lLy4vc3JjL21vZGVsL2NvbXBvbmVudHMvc2hhcGUudHMiLCJ3ZWJwYWNrOi8vc21hbGwtZ2FtZS8uL3NyYy9tb2RlbC9jb21wb25lbnRzL21vdmFibGVTaGFwZS50cyIsIndlYnBhY2s6Ly9zbWFsbC1nYW1lLy4vc3JjL21vZGVsL2NvbXBvbmVudHMvcGxheWVyLnRzIiwid2VicGFjazovL3NtYWxsLWdhbWUvLi9zcmMvbW9kZWwvY2xhc3Nlcy9jb21wdXRlclBsYXllci50cyIsIndlYnBhY2s6Ly9zbWFsbC1nYW1lLy4vc3JjL21vZGVsL2NsYXNzZXMvb2JzdGFjbGUudHMiLCJ3ZWJwYWNrOi8vc21hbGwtZ2FtZS8uL3NyYy9tb2RlbC9jb21wb25lbnRzL2hlYWx0aC50cyIsIndlYnBhY2s6Ly9zbWFsbC1nYW1lLy4vc3JjL21vZGVsL2NvbXBvbmVudHMvc2hvdC50cyIsIndlYnBhY2s6Ly9zbWFsbC1nYW1lLy4vc3JjL21vZGVsL2NvbXBvbmVudHMvc2hvb3Rlci50cyIsIndlYnBhY2s6Ly9zbWFsbC1nYW1lLy4vc3JjL2RlZmF1bHRHYW1lLnRzIiwid2VicGFjazovL3NtYWxsLWdhbWUvLi9zcmMvbW9kZWwvY2xhc3Nlcy9odW1hblBsYXllci50cyIsIndlYnBhY2s6Ly9zbWFsbC1nYW1lLy4vc3JjL21vZGVsL2NvbXBvbmVudHMvY29udHJvbHMudHMiLCJ3ZWJwYWNrOi8vc21hbGwtZ2FtZS8uL3NyYy9tb2RlbC9jbGFzc2VzL3dvcmxkLnRzIiwid2VicGFjazovL3NtYWxsLWdhbWUvLi9zcmMvaW5kZXgudHMiLCJ3ZWJwYWNrOi8vc21hbGwtZ2FtZS8uL3NyYy9tb2RlbC9jbGFzc2VzL2dhbWUudHMiXSwibmFtZXMiOlsiU2hhcGUiLCJ4IiwieSIsIndpZHRoIiwiaGVpZ2h0Iiwib3RoZXJTaGFwZSIsInRoaXMiLCJ0b3BMZWZ0IiwiYm90dG9tUmlnaHQiLCJ0b3BSaWdodCIsIm90aGVyU2hhcGVzIiwic29tZSIsImNvbGxpZGVzV2l0aCIsImZpbHRlciIsIk1vdmFibGVTaGFwZSIsImRlbHRhWCIsImRlbHRhWSIsIm1vdmVtZW50QW1vdW50Iiwic3VwZXIiLCJtb3ZlQnkiLCJQbGF5ZXIiLCJkZXRhaWxzIiwiaGVhbHRoIiwic2hvb3RlciIsImF0Iiwic2hvb3QiLCJjZW50ZXIiLCJjdHgiLCJmaWxsU3R5bGUiLCJjb2xvdXIiLCJmaWxsUmVjdCIsImN1cnJlbnRDb2xvdXIiLCJjdXJyZW50UGVyY2VudGFnZSIsInN0cm9rZVN0eWxlIiwibGluZVdpZHRoIiwic3Ryb2tlUmVjdCIsImZpbGxUZXh0IiwibmFtZSIsIkNvbXB1dGVyUGxheWVyIiwiY3VycmVudFRpbWUiLCJEYXRlIiwiZ2V0VGltZSIsImNoYW5nZWREZWx0YVgiLCJjaGFuZ2VkRGVsdGFZIiwic2hvdCIsInNob3VsZENoYW5nZURpcmVjdGlvbiIsImxlZnRPclJpZ2h0IiwiTWF0aCIsInJhbmRvbSIsInVwT3JEb3duIiwibWF5YmVDaGFuZ2VEaXJlY3Rpb24iLCJtb3ZlIiwic2hvdWxkU2hvb3QiLCJPYnN0YWNsZSIsIkhlYWx0aCIsIm1heEhlYWx0aCIsImN1cnJlbnRIZWFsdGgiLCJjaGFuZ2UiLCJtYXgiLCJTaG90IiwiZnJvbSIsInRvIiwic3BlZWQiLCJkYW1hZ2UiLCJvcmlnaW5hbERlbHRhIiwicmFkaWFucyIsImF0YW4yIiwiY29zIiwic2luIiwiU2hvb3RlciIsInNob3RzRmlyZWQiLCJwdXNoIiwic2hvdFRvUmVtb3ZlIiwic2hvdHNUb1JlbW92ZSIsImluY2x1ZGVzIiwicHJlZGljYXRlIiwiYmlnR3V5Iiwic3RyYW5nZU9uZSIsIm1haW5Db21wdXRlciIsImRlZmF1bHRDb25maWciLCJwbGF5ZXJzIiwiY29udHJvbHMiLCJvbklucHV0SGFuZGxlciIsImlucHV0IiwibmV3U3RhdGUiLCJldmVudCIsIm9mZnNldFgiLCJvZmZzZXRZIiwiaW5wdXRzIiwiS2V5VyIsIktleVMiLCJLZXlBIiwiS2V5RCIsImNhbnZhcyIsIndpbmRvdyIsIkxNQiIsIm5ld1ZhbHVlIiwiY29uc29sZSIsImxvZyIsImNsaWNrTGlzdGVuZXIiLCJlIiwiYnV0dG9uIiwidHlwZSIsImtleUxpc3RlbmVyIiwiY29kZSIsImhhc093blByb3BlcnR5IiwiYWRkRXZlbnRMaXN0ZW5lciIsIm5ld0hhbmRsZXIiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJvYnN0YWNsZXMiLCJ3b3JsZCIsImdldENvbnRleHQiLCJwbGF5ZXIiLCJwbGF5ZXJUb0V4Y2x1ZGUiLCJjb21wdXRlclBsYXllciIsImNvbXB1dGVyUGxheWVycyIsInBsYXllclRvU2hvb3QiLCJmaW5kIiwiaXNFbXB0eSIsImV4dGVuZHNCZXlvbmQiLCJjb2xsaWRlc1dpdGhBbnkiLCJvdGhlclBsYXllcnMiLCJtb3ZlQmFjayIsInByb2Nlc3NDb2xsaXNpb25zIiwia2VlcFNob3RzV2hlcmUiLCJvYnN0YWNsZXNTaG90IiwiZ2V0QWxsQ29sbGlzaW9uc1dpdGgiLCJmb3JFYWNoIiwib2JzdGFjbGUiLCJjaGFuZ2VIZWFsdGhCeSIsInBsYXllcnNTaG90IiwibGVuZ3RoIiwiY2xlYXJSZWN0IiwiZHJhdyIsInJlbWFpbmluZ1BsYXllcnMiLCJ1cGRhdGVQb3NpdGlvbnMiLCJ3aW5uZXJPck51bGwiLCJnZXRXaW5uZXJPck51bGwiLCJzZXRUaW1lb3V0IiwiYWxlcnQiLCJyZXF1ZXN0QW5pbWF0aW9uRnJhbWUiLCJwbGF5IiwiYmluZCJdLCJtYXBwaW5ncyI6Im1CQUVPLE1BQWVBLEVBQ3BCLFlBQ1NDLEVBQ0FDLEVBQ0FDLEVBQ0FDLEdBSEEsS0FBQUgsSUFDQSxLQUFBQyxJQUNBLEtBQUFDLFFBQ0EsS0FBQUMsU0FHVCxhQUFhQyxHQUNYLE9BQ0VDLEtBQUtDLFFBQVFOLEVBQUlJLEVBQVdHLFlBQVlQLEdBQ3hDSyxLQUFLRSxZQUFZUCxFQUFJSSxFQUFXRSxRQUFRTixHQUN4Q0ssS0FBS0MsUUFBUUwsRUFBSUcsRUFBV0csWUFBWU4sR0FDeENJLEtBQUtFLFlBQVlOLEVBQUlHLEVBQVdJLFNBQVNQ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RyxLQUFVM0csS0FBSzBFLFFBQVMsQ0FDakNpQyxFQUFPcUIsS0FBSyxFQUFBaEksS0FBQSxJQUVaLElBQUssTUFBTXNDLEtBQVFxRSxFQUFPMUYsUUFBUStDLFdBQ2hDMUIsRUFBSzBGLEtBQUssRUFBQWhJLEtBQUEsSUFHWixJQUFLLE1BQU0ySCxLQUFZM0gsS0FBS3dHLFVBQzFCbUIsRUFBU0ssS0FBSyxFQUFBaEksS0FBQSxLQUtwQixrQkFDRSxNQUFNaUksRUFBbUJqSSxLQUFLMEUsUUFBUW5FLFFBQ25Db0csSUFBWUEsRUFBTzNGLE9BQU9pRyxVQUc3QixPQUFtQyxJQUE1QmdCLEVBQWlCSCxPQUFlRyxFQUFpQixHQUFLLEtBRy9ELE9BQ0VqSSxLQUFLa0ksa0JBQ0xsSSxLQUFLZ0ksT0FDTCxNQUFNRyxFQUFlbkksS0FBS29JLGtCQUN0QkQsRUFDRkUsWUFBVyxJQUFNQyxNQUFTSCxFQUFhcEgsUUFBUWdCLEtBQXhCLFVBQXNDLElBSS9Ed0csc0JBQXNCdkksS0FBS3dJLEtBQUtDLEtBQUt6SSxTRHpIbkIsRUFBTyxFQUFTLEVBQVd1RixHQUM1Q2lELFEiLCJmaWxlIjoiYnVuZGxlLmpzIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUG9zaXRpb25EZXRhaWxzIH0gZnJvbSBcIi4uL2ludGVyZmFjZXMvcG9zaXRpb25EZXRhaWxzXCI7XHJcblxyXG5leHBvcnQgYWJzdHJhY3QgY2xhc3MgU2hhcGUge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHVibGljIHg6IG51bWJlcixcclxuICAgIHB1YmxpYyB5OiBudW1iZXIsXHJcbiAgICBwdWJsaWMgd2lkdGg6IG51bWJlcixcclxuICAgIHB1YmxpYyBoZWlnaHQ6IG51bWJlclxyXG4gICkge31cclxuXHJcbiAgY29sbGlkZXNXaXRoKG90aGVyU2hhcGU6IFNoYXBlKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gKFxyXG4gICAgICB0aGlzLnRvcExlZnQueCA8IG90aGVyU2hhcGUuYm90dG9tUmlnaHQueCAmJlxyXG4gICAgICB0aGlzLmJvdHRvbVJpZ2h0LnggPiBvdGhlclNoYXBlLnRvcExlZnQueCAmJlxyXG4gICAgICB0aGlzLnRvcExlZnQueSA8IG90aGVyU2hhcGUuYm90dG9tUmlnaHQueSAmJlxyXG4gICAgICB0aGlzLmJvdHRvbVJpZ2h0LnkgPiBvdGhlclNoYXBlLnRvcFJpZ2h0LnlcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBjb2xsaWRlc1dpdGhBbnkoLi4ub3RoZXJTaGFwZXM6IFNoYXBlW10pOiBib29sZWFuIHtcclxuICAgIHJldHVybiBvdGhlclNoYXBlcy5zb21lKChvdGhlclNoYXBlKSA9PiB0aGlzLmNvbGxpZGVzV2l0aChvdGhlclNoYXBlKSk7XHJcbiAgfVxyXG5cclxuICBleHRlbmRzQmV5b25kKG90aGVyU2hhcGU6IFNoYXBlKTogYm9vbGVhbiB7XHJcbiAgICByZXR1cm4gKFxyXG4gICAgICB0aGlzLnRvcExlZnQueCA8IG90aGVyU2hhcGUudG9wTGVmdC54IHx8XHJcbiAgICAgIHRoaXMuYm90dG9tUmlnaHQueCA+IG90aGVyU2hhcGUuYm90dG9tUmlnaHQueCB8fFxyXG4gICAgICB0aGlzLnRvcExlZnQueSA8IG90aGVyU2hhcGUudG9wTGVmdC55IHx8XHJcbiAgICAgIHRoaXMuYm90dG9tUmlnaHQueSA+IG90aGVyU2hhcGUuYm90dG9tUmlnaHQueVxyXG4gICAgKTtcclxuICB9XHJcblxyXG4gIGdldEFsbENvbGxpc2lvbnNXaXRoPFQgZXh0ZW5kcyBTaGFwZT4oLi4ub3RoZXJTaGFwZXM6IFRbXSk6IFRbXSB7XHJcbiAgICByZXR1cm4gb3RoZXJTaGFwZXMuZmlsdGVyKChvdGhlclNoYXBlKSA9PiB0aGlzLmNvbGxpZGVzV2l0aChvdGhlclNoYXBlKSk7XHJcbiAgfVxyXG5cclxuICBhYnN0cmFjdCBkcmF3KGN0eDogQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEKTogdm9pZDtcclxuXHJcbiAgZ2V0IHRvcExlZnQoKTogUG9zaXRpb25EZXRhaWxzIHtcclxuICAgIHJldHVybiB7XHJcbiAgICAgIHg6IHRoaXMueCxcclxuICAgICAgeTogdGhpcy55LFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIGdldCB0b3BSaWdodCgpOiBQb3NpdGlvbkRldGFpbHMge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgeDogdGhpcy54ICsgdGhpcy53aWR0aCxcclxuICAgICAgeTogdGhpcy55LFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIGdldCBib3R0b21MZWZ0KCk6IFBvc2l0aW9uRGV0YWlscyB7XHJcbiAgICByZXR1cm4ge1xyXG4gICAgICB4OiB0aGlzLngsXHJcbiAgICAgIHk6IHRoaXMueSArIHRoaXMuaGVpZ2h0LFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIGdldCBib3R0b21SaWdodCgpOiBQb3NpdGlvbkRldGFpbHMge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgeDogdGhpcy54ICsgdGhpcy53aWR0aCxcclxuICAgICAgeTogdGhpcy55ICsgdGhpcy5oZWlnaHQsXHJcbiAgICB9O1xyXG4gIH1cclxuXHJcbiAgZ2V0IGNlbnRlcigpOiBQb3NpdGlvbkRldGFpbHMge1xyXG4gICAgcmV0dXJuIHtcclxuICAgICAgeDogdGhpcy54ICsgdGhpcy53aWR0aCAvIDIsXHJcbiAgICAgIHk6IHRoaXMueSArIHRoaXMuaGVpZ2h0IC8gMixcclxuICAgIH07XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IFNoYXBlIH0gZnJvbSBcIi4vc2hhcGVcIjtcclxuXHJcbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBNb3ZhYmxlU2hhcGUgZXh0ZW5kcyBTaGFwZSB7XHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICB4OiBudW1iZXIsXHJcbiAgICB5OiBudW1iZXIsXHJcbiAgICB3aWR0aDogbnVtYmVyLFxyXG4gICAgaGVpZ2h0OiBudW1iZXIsXHJcbiAgICBwdWJsaWMgZGVsdGFYOiBudW1iZXIgPSAwLFxyXG4gICAgcHVibGljIGRlbHRhWTogbnVtYmVyID0gMCxcclxuICAgIHB1YmxpYyBtb3ZlbWVudEFtb3VudDogbnVtYmVyID0gNVxyXG4gICkge1xyXG4gICAgc3VwZXIoeCwgeSwgd2lkdGgsIGhlaWdodCk7XHJcbiAgfVxyXG5cclxuICBtb3ZlQnkoZGVsdGFYOiBudW1iZXIsIGRlbHRhWTogbnVtYmVyKTogdm9pZCB7XHJcbiAgICB0aGlzLnggKz0gZGVsdGFYO1xyXG4gICAgdGhpcy55ICs9IGRlbHRhWTtcclxuICB9XHJcblxyXG4gIG1vdmUoKTogdm9pZCB7XHJcbiAgICB0aGlzLnggKz0gdGhpcy5kZWx0YVg7XHJcbiAgICB0aGlzLnkgKz0gdGhpcy5kZWx0YVk7XHJcbiAgfVxyXG5cclxuICBtb3ZlQmFjaygpOiB2b2lkIHtcclxuICAgIHRoaXMubW92ZUJ5KC10aGlzLmRlbHRhWCwgLXRoaXMuZGVsdGFZKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgUGxheWVyRGV0YWlscyB9IGZyb20gXCIuLi9pbnRlcmZhY2VzL3BsYXllckRldGFpbHNcIjtcclxuaW1wb3J0IHsgUG9zaXRpb25EZXRhaWxzIH0gZnJvbSBcIi4uL2ludGVyZmFjZXMvcG9zaXRpb25EZXRhaWxzXCI7XHJcbmltcG9ydCB7IEhlYWx0aCB9IGZyb20gXCIuL2hlYWx0aFwiO1xyXG5pbXBvcnQgeyBNb3ZhYmxlU2hhcGUgfSBmcm9tIFwiLi9tb3ZhYmxlU2hhcGVcIjtcclxuaW1wb3J0IHsgU2hvb3RlciB9IGZyb20gXCIuL3Nob290ZXJcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBQbGF5ZXIgZXh0ZW5kcyBNb3ZhYmxlU2hhcGUge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHVibGljIGRldGFpbHM6IFBsYXllckRldGFpbHMsXHJcbiAgICB4OiBudW1iZXIsXHJcbiAgICB5OiBudW1iZXIsXHJcbiAgICBwdWJsaWMgaGVhbHRoOiBIZWFsdGgsXHJcbiAgICBwdWJsaWMgc2hvb3RlcjogU2hvb3RlcixcclxuICAgIHdpZHRoOiBudW1iZXIgPSAxMDAsXHJcbiAgICBoZWlnaHQ6IG51bWJlciA9IDEwMCxcclxuICAgIGRlbHRhWDogbnVtYmVyID0gMCxcclxuICAgIGRlbHRhWTogbnVtYmVyID0gMFxyXG4gICkge1xyXG4gICAgc3VwZXIoeCwgeSwgd2lkdGgsIGhlaWdodCwgZGVsdGFYLCBkZWx0YVkpO1xyXG4gIH1cclxuXHJcbiAgc2hvb3QoYXQ6IFBvc2l0aW9uRGV0YWlscyk6IHZvaWQge1xyXG4gICAgdGhpcy5zaG9vdGVyLnNob290KFxyXG4gICAgICB7XHJcbiAgICAgICAgeDogdGhpcy5jZW50ZXIueCxcclxuICAgICAgICB5OiB0aGlzLmNlbnRlci55LFxyXG4gICAgICB9LFxyXG4gICAgICB7XHJcbiAgICAgICAgeDogYXQueCxcclxuICAgICAgICB5OiBhdC55LFxyXG4gICAgICB9XHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgZHJhdyhjdHg6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCk6IHZvaWQge1xyXG4gICAgLy8gUGxheWVyIHNwcml0ZVxyXG4gICAgY3R4LmZpbGxTdHlsZSA9IHRoaXMuZGV0YWlscy5jb2xvdXI7XHJcbiAgICBjdHguZmlsbFJlY3QodGhpcy54LCB0aGlzLnksIHRoaXMud2lkdGgsIHRoaXMuaGVpZ2h0KTtcclxuXHJcbiAgICAvLyBQbGF5ZXIgSFAgYmFyXHJcbiAgICBjdHguZmlsbFN0eWxlID0gdGhpcy5oZWFsdGguY3VycmVudENvbG91cjtcclxuICAgIGN0eC5maWxsUmVjdChcclxuICAgICAgdGhpcy54LFxyXG4gICAgICB0aGlzLnkgLSA0MCxcclxuICAgICAgdGhpcy5oZWFsdGguY3VycmVudFBlcmNlbnRhZ2UgKiB0aGlzLndpZHRoLFxyXG4gICAgICAyMFxyXG4gICAgKTtcclxuICAgIGN0eC5zdHJva2VTdHlsZSA9IFwiYmxhY2tcIjtcclxuICAgIGN0eC5saW5lV2lkdGggPSAyO1xyXG4gICAgY3R4LnN0cm9rZVJlY3QodGhpcy54LCB0aGlzLnkgLSA0MCwgdGhpcy53aWR0aCwgMjApO1xyXG5cclxuICAgIC8vIFBsYXllciBuYW1lXHJcbiAgICBjdHguZmlsbFN0eWxlID0gXCJibGFja1wiO1xyXG4gICAgY3R4LmZpbGxUZXh0KHRoaXMuZGV0YWlscy5uYW1lLCB0aGlzLngsIHRoaXMueSAtIDUwKTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgSGVhbHRoIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvaGVhbHRoXCI7XHJcbmltcG9ydCB7IFBsYXllciB9IGZyb20gXCIuLi9jb21wb25lbnRzL3BsYXllclwiO1xyXG5pbXBvcnQgeyBTaG9vdGVyIH0gZnJvbSBcIi4uL2NvbXBvbmVudHMvc2hvb3RlclwiO1xyXG5pbXBvcnQgeyBQbGF5ZXJEZXRhaWxzIH0gZnJvbSBcIi4uL2ludGVyZmFjZXMvcGxheWVyRGV0YWlsc1wiO1xyXG5pbXBvcnQgeyBQb3NpdGlvbkRldGFpbHMgfSBmcm9tIFwiLi4vaW50ZXJmYWNlcy9wb3NpdGlvbkRldGFpbHNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBDb21wdXRlclBsYXllciBleHRlbmRzIFBsYXllciB7XHJcbiAgI2xhc3RBY3Rpb25zOiB7XHJcbiAgICBjaGFuZ2VkRGVsdGFYOiBudW1iZXI7XHJcbiAgICBjaGFuZ2VkRGVsdGFZOiBudW1iZXI7XHJcbiAgICBzaG90OiBudW1iZXI7XHJcbiAgfTtcclxuXHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBwdWJsaWMgZGV0YWlsczogUGxheWVyRGV0YWlscyxcclxuICAgIHg6IG51bWJlcixcclxuICAgIHk6IG51bWJlcixcclxuICAgIHB1YmxpYyBoZWFsdGg6IEhlYWx0aCxcclxuICAgIHB1YmxpYyBzaG9vdGVyOiBTaG9vdGVyLFxyXG4gICAgd2lkdGg6IG51bWJlciA9IDEwMCxcclxuICAgIGhlaWdodDogbnVtYmVyID0gMTAwXHJcbiAgKSB7XHJcbiAgICBzdXBlcihkZXRhaWxzLCB4LCB5LCBoZWFsdGgsIHNob290ZXIsIHdpZHRoLCBoZWlnaHQpO1xyXG5cclxuICAgIGNvbnN0IGN1cnJlbnRUaW1lID0gbmV3IERhdGUoKS5nZXRUaW1lKCk7XHJcbiAgICB0aGlzLiNsYXN0QWN0aW9ucyA9IHtcclxuICAgICAgY2hhbmdlZERlbHRhWDogY3VycmVudFRpbWUsXHJcbiAgICAgIGNoYW5nZWREZWx0YVk6IGN1cnJlbnRUaW1lLFxyXG4gICAgICBzaG90OiBjdXJyZW50VGltZSxcclxuICAgIH07XHJcbiAgfVxyXG5cclxuICBnZXQgc2hvdWxkQ2hhbmdlRGlyZWN0aW9uKCk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIG5ldyBEYXRlKCkuZ2V0VGltZSgpID4gdGhpcy4jbGFzdEFjdGlvbnMuY2hhbmdlZERlbHRhWCArIDEwMDtcclxuICB9XHJcblxyXG4gIGdldCBzaG91bGRTaG9vdCgpOiBib29sZWFuIHtcclxuICAgIHJldHVybiBuZXcgRGF0ZSgpLmdldFRpbWUoKSA+IHRoaXMuI2xhc3RBY3Rpb25zLnNob3QgKyA1MDA7XHJcbiAgfVxyXG5cclxuICBtYXliZUNoYW5nZURpcmVjdGlvbigpOiB2b2lkIHtcclxuICAgIGlmICh0aGlzLnNob3VsZENoYW5nZURpcmVjdGlvbikge1xyXG4gICAgICBjb25zdCBsZWZ0T3JSaWdodCA9IE1hdGgucmFuZG9tKCkgPCAwLjUgPyAtMSA6IDE7XHJcbiAgICAgIHRoaXMuZGVsdGFYID0gTWF0aC5yYW5kb20oKSAqIDUgKiBsZWZ0T3JSaWdodDtcclxuXHJcbiAgICAgIGNvbnN0IHVwT3JEb3duID0gTWF0aC5yYW5kb20oKSA8IDAuNSA/IC0xIDogMTtcclxuICAgICAgdGhpcy5kZWx0YVkgPSBNYXRoLnJhbmRvbSgpICogNSAqIHVwT3JEb3duO1xyXG5cclxuICAgICAgY29uc3QgY3VycmVudFRpbWUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKTtcclxuICAgICAgdGhpcy4jbGFzdEFjdGlvbnMuY2hhbmdlZERlbHRhWCA9IGN1cnJlbnRUaW1lO1xyXG4gICAgICB0aGlzLiNsYXN0QWN0aW9ucy5jaGFuZ2VkRGVsdGFZID0gY3VycmVudFRpbWU7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBtb3ZlKCk6IHZvaWQge1xyXG4gICAgdGhpcy5tYXliZUNoYW5nZURpcmVjdGlvbigpO1xyXG4gICAgc3VwZXIubW92ZSgpO1xyXG4gIH1cclxuXHJcbiAgc2hvb3QoYXQ6IFBvc2l0aW9uRGV0YWlscyk6IHZvaWQge1xyXG4gICAgaWYgKHRoaXMuc2hvdWxkU2hvb3QpIHtcclxuICAgICAgdGhpcy4jbGFzdEFjdGlvbnMuc2hvdCA9IG5ldyBEYXRlKCkuZ2V0VGltZSgpO1xyXG4gICAgICBzdXBlci5zaG9vdChhdCk7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcbiIsImltcG9ydCB7IEhlYWx0aCB9IGZyb20gXCIuLi9jb21wb25lbnRzL2hlYWx0aFwiO1xyXG5pbXBvcnQgeyBTaGFwZSB9IGZyb20gXCIuLi9jb21wb25lbnRzL3NoYXBlXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgT2JzdGFjbGUgZXh0ZW5kcyBTaGFwZSB7XHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICB4OiBudW1iZXIsXHJcbiAgICB5OiBudW1iZXIsXHJcbiAgICB3aWR0aDogbnVtYmVyLFxyXG4gICAgaGVpZ2h0OiBudW1iZXIsXHJcbiAgICBwdWJsaWMgaGVhbHRoOiBIZWFsdGhcclxuICApIHtcclxuICAgIHN1cGVyKHgsIHksIHdpZHRoLCBoZWlnaHQpO1xyXG4gIH1cclxuXHJcbiAgZHJhdyhjdHg6IENhbnZhc1JlbmRlcmluZ0NvbnRleHQyRCk6IHZvaWQge1xyXG4gICAgLy8gT2JzdGFjbGVcclxuICAgIGN0eC5maWxsU3R5bGUgPSBcIiM3MDQzMDBcIjtcclxuICAgIGN0eC5maWxsUmVjdCh0aGlzLngsIHRoaXMueSwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQpO1xyXG5cclxuICAgIC8vIE9ic3RhY2xlIEhQIGJhclxyXG4gICAgY3R4LmZpbGxTdHlsZSA9IHRoaXMuaGVhbHRoLmN1cnJlbnRDb2xvdXI7XHJcbiAgICBjdHguZmlsbFJlY3QoXHJcbiAgICAgIHRoaXMueCxcclxuICAgICAgdGhpcy55IC0gNDAsXHJcbiAgICAgIHRoaXMuaGVhbHRoLmN1cnJlbnRQZXJjZW50YWdlICogdGhpcy53aWR0aCxcclxuICAgICAgMjBcclxuICAgICk7XHJcbiAgICBjdHguc3Ryb2tlU3R5bGUgPSBcImJsYWNrXCI7XHJcbiAgICBjdHgubGluZVdpZHRoID0gMjtcclxuICAgIGN0eC5zdHJva2VSZWN0KHRoaXMueCwgdGhpcy55IC0gNDAsIHRoaXMud2lkdGgsIDIwKTtcclxuICB9XHJcbn1cclxuIiwidHlwZSBIZWFsdGhDb2xvdXIgPSBcImdyZWVuXCIgfCBcInllbGxvd1wiIHwgXCJyZWRcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBIZWFsdGgge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHJpdmF0ZSBtYXhIZWFsdGg6IG51bWJlcixcclxuICAgIHByaXZhdGUgY3VycmVudEhlYWx0aDogbnVtYmVyID0gbWF4SGVhbHRoXHJcbiAgKSB7fVxyXG5cclxuICBjaGFuZ2VIZWFsdGhCeShjaGFuZ2U6IG51bWJlcik6IHZvaWQge1xyXG4gICAgdGhpcy5jdXJyZW50SGVhbHRoID0gTWF0aC5tYXgoMCwgdGhpcy5jdXJyZW50SGVhbHRoICsgY2hhbmdlKTtcclxuICB9XHJcblxyXG4gIGdldCBpc0VtcHR5KCk6IGJvb2xlYW4ge1xyXG4gICAgcmV0dXJuIHRoaXMuY3VycmVudEhlYWx0aCA9PT0gMDtcclxuICB9XHJcblxyXG4gIGdldCBjdXJyZW50UGVyY2VudGFnZSgpOiBudW1iZXIge1xyXG4gICAgcmV0dXJuIHRoaXMuY3VycmVudEhlYWx0aCAvIHRoaXMubWF4SGVhbHRoO1xyXG4gIH1cclxuXHJcbiAgZ2V0IGN1cnJlbnRDb2xvdXIoKTogSGVhbHRoQ29sb3VyIHtcclxuICAgIGlmICh0aGlzLmN1cnJlbnRQZXJjZW50YWdlID4gMC42KSB7XHJcbiAgICAgIHJldHVybiBcImdyZWVuXCI7XHJcbiAgICB9IGVsc2UgaWYgKHRoaXMuY3VycmVudFBlcmNlbnRhZ2UgPiAwLjQpIHtcclxuICAgICAgcmV0dXJuIFwieWVsbG93XCI7XHJcbiAgICB9XHJcbiAgICByZXR1cm4gXCJyZWRcIjtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgTW92YWJsZVNoYXBlIH0gZnJvbSBcIi4vbW92YWJsZVNoYXBlXCI7XHJcbmltcG9ydCB7IFBvc2l0aW9uRGV0YWlscyB9IGZyb20gXCIuLi9pbnRlcmZhY2VzL3Bvc2l0aW9uRGV0YWlsc1wiO1xyXG5cclxuZXhwb3J0IGNsYXNzIFNob3QgZXh0ZW5kcyBNb3ZhYmxlU2hhcGUge1xyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgZnJvbTogUG9zaXRpb25EZXRhaWxzLFxyXG4gICAgdG86IFBvc2l0aW9uRGV0YWlscyxcclxuICAgIHdpZHRoOiBudW1iZXIgPSA1LFxyXG4gICAgaGVpZ2h0OiBudW1iZXIgPSA1LFxyXG4gICAgcHVibGljIHNwZWVkOiBudW1iZXIgPSAxNSxcclxuICAgIHB1YmxpYyBkYW1hZ2U6IG51bWJlciA9IDEwXHJcbiAgKSB7XHJcbiAgICBzdXBlcihmcm9tLngsIGZyb20ueSwgd2lkdGgsIGhlaWdodCwgMCwgMCk7XHJcblxyXG4gICAgY29uc3Qgb3JpZ2luYWxEZWx0YSA9IHtcclxuICAgICAgZGVsdGFYOiB0by54IC0gZnJvbS54LCAvLyBBIGluIENBSFxyXG4gICAgICBkZWx0YVk6IHRvLnkgLSBmcm9tLnksIC8vIE8gaW4gU09IXHJcbiAgICB9O1xyXG5cclxuICAgIGNvbnN0IHJhZGlhbnMgPSBNYXRoLmF0YW4yKG9yaWdpbmFsRGVsdGEuZGVsdGFZLCBvcmlnaW5hbERlbHRhLmRlbHRhWCk7XHJcbiAgICB0aGlzLmRlbHRhWCA9IE1hdGguY29zKHJhZGlhbnMpICogc3BlZWQ7IC8vIENBSFxyXG4gICAgdGhpcy5kZWx0YVkgPSBNYXRoLnNpbihyYWRpYW5zKSAqIHNwZWVkOyAvLyBTT0hcclxuICB9XHJcblxyXG4gIGRyYXcoY3R4OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQpOiB2b2lkIHtcclxuICAgIGN0eC5maWxsU3R5bGUgPSBcImdvbGRlbnJvZFwiO1xyXG4gICAgY3R4LmZpbGxSZWN0KHRoaXMueCwgdGhpcy55LCA3LCA3KTtcclxuICB9XHJcbn1cclxuIiwiaW1wb3J0IHsgUG9zaXRpb25EZXRhaWxzIH0gZnJvbSBcIi4uL2ludGVyZmFjZXMvcG9zaXRpb25EZXRhaWxzXCI7XHJcbmltcG9ydCB7IFNob3QgfSBmcm9tIFwiLi9zaG90XCI7XHJcblxyXG50eXBlIGZpbHRlclByZWRpY2F0ZSA9IChzaG90OiBTaG90LCBpbmRleDogbnVtYmVyLCBhcnJheTogU2hvdFtdKSA9PiBib29sZWFuO1xyXG5cclxuZXhwb3J0IGNsYXNzIFNob290ZXIge1xyXG4gIHNob3RzRmlyZWQ6IFNob3RbXTtcclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIHRoaXMuc2hvdHNGaXJlZCA9IFtdO1xyXG4gIH1cclxuXHJcbiAgc2hvb3QoZnJvbTogUG9zaXRpb25EZXRhaWxzLCBhdDogUG9zaXRpb25EZXRhaWxzKTogdm9pZCB7XHJcbiAgICBjb25zdCBzaG90ID0gbmV3IFNob3QoZnJvbSwgYXQpO1xyXG4gICAgdGhpcy5zaG90c0ZpcmVkLnB1c2goc2hvdCk7XHJcbiAgfVxyXG5cclxuICByZW1vdmUoc2hvdFRvUmVtb3ZlOiBTaG90KTogdm9pZCB7XHJcbiAgICB0aGlzLnNob3RzRmlyZWQgPSB0aGlzLnNob3RzRmlyZWQuZmlsdGVyKChzaG90KSA9PiBzaG90ICE9PSBzaG90VG9SZW1vdmUpO1xyXG4gIH1cclxuXHJcbiAgcmVtb3ZlU2hvdHMoLi4uc2hvdHNUb1JlbW92ZTogU2hvdFtdKTogdm9pZCB7XHJcbiAgICB0aGlzLnNob3RzRmlyZWQgPSB0aGlzLnNob3RzRmlyZWQuZmlsdGVyKFxyXG4gICAgICAoc2hvdCkgPT4gIXNob3RzVG9SZW1vdmUuaW5jbHVkZXMoc2hvdClcclxuICAgICk7XHJcbiAgfVxyXG5cclxuICBrZWVwU2hvdHNXaGVyZShwcmVkaWNhdGU6IGZpbHRlclByZWRpY2F0ZSk6IHZvaWQge1xyXG4gICAgdGhpcy5zaG90c0ZpcmVkID0gdGhpcy5zaG90c0ZpcmVkLmZpbHRlcihwcmVkaWNhdGUpO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBDb21wdXRlclBsYXllciB9IGZyb20gXCIuL21vZGVsL2NsYXNzZXMvY29tcHV0ZXJQbGF5ZXJcIjtcclxuaW1wb3J0IHsgSHVtYW5QbGF5ZXIgfSBmcm9tIFwiLi9tb2RlbC9jbGFzc2VzL2h1bWFuUGxheWVyXCI7XHJcbmltcG9ydCB7IE9ic3RhY2xlIH0gZnJvbSBcIi4vbW9kZWwvY2xhc3Nlcy9vYnN0YWNsZVwiO1xyXG5pbXBvcnQgeyBXb3JsZCB9IGZyb20gXCIuL21vZGVsL2NsYXNzZXMvd29ybGRcIjtcclxuaW1wb3J0IHsgSGVhbHRoIH0gZnJvbSBcIi4vbW9kZWwvY29tcG9uZW50cy9oZWFsdGhcIjtcclxuaW1wb3J0IHsgU2hvb3RlciB9IGZyb20gXCIuL21vZGVsL2NvbXBvbmVudHMvc2hvb3RlclwiO1xyXG5pbXBvcnQgeyBQbGF5ZXIgfSBmcm9tIFwiLi9tb2RlbC9jb21wb25lbnRzL3BsYXllclwiO1xyXG5pbXBvcnQgeyBDb250cm9scyB9IGZyb20gXCIuL21vZGVsL2NvbXBvbmVudHMvY29udHJvbHNcIjtcclxuXHJcbmNvbnN0IGJpZ0d1eSA9IG5ldyBDb21wdXRlclBsYXllcihcclxuICB7IG5hbWU6IFwiYmlnX2d1eTE5NTQgKPCflqXvuI8pXCIsIGNvbG91cjogXCJwdXJwbGVcIiB9LFxyXG4gIDMwMCxcclxuICAzMDAsXHJcbiAgbmV3IEhlYWx0aCg0MDApLFxyXG4gIG5ldyBTaG9vdGVyKClcclxuKTtcclxuXHJcbmNvbnN0IHN0cmFuZ2VPbmUgPSBuZXcgQ29tcHV0ZXJQbGF5ZXIoXHJcbiAgeyBuYW1lOiBcInN0cmFuZ2VPbmU0NSAo8J+Wpe+4jylcIiwgY29sb3VyOiBcInJlZFwiIH0sXHJcbiAgMzAwLFxyXG4gIDUwLFxyXG4gIG5ldyBIZWFsdGgoNTApLFxyXG4gIG5ldyBTaG9vdGVyKCksXHJcbiAgMjAsXHJcbiAgMjBcclxuKTtcclxuXHJcbmNvbnN0IG1haW5Db21wdXRlciA9IG5ldyBDb21wdXRlclBsYXllcihcclxuICB7IG5hbWU6IFwiMDEwMTAxMDEwMSAo8J+Wpe+4jylcIiwgY29sb3VyOiBcIm5hdnlcIiB9LFxyXG4gIDQwMCxcclxuICAyMDAsXHJcbiAgbmV3IEhlYWx0aCgxMDApLFxyXG4gIG5ldyBTaG9vdGVyKClcclxuKTtcclxuXHJcbmNvbnN0IGh1bWFuUGxheWVyID0gbmV3IEh1bWFuUGxheWVyKFxyXG4gIHsgbmFtZTogXCJZb3UgKPCfjq4pXCIsIGNvbG91cjogXCJvbGl2ZVwiIH0sXHJcbiAgMCxcclxuICA0MDAsXHJcbiAgbmV3IEhlYWx0aCgyMDApLFxyXG4gIG5ldyBDb250cm9scyhkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiY2FudmFzXCIpISwgd2luZG93KSxcclxuICBuZXcgU2hvb3RlcigpXHJcbik7XHJcblxyXG5jb25zdCBwbGF5ZXJzOiBQbGF5ZXJbXSA9IFtodW1hblBsYXllciwgYmlnR3V5LCBzdHJhbmdlT25lLCBtYWluQ29tcHV0ZXJdO1xyXG5cclxuY29uc3Qgb2JzdGFjbGVzID0gW1xyXG4gIG5ldyBPYnN0YWNsZSgyMDAsIDIwMCwgNTAsIDUwLCBuZXcgSGVhbHRoKDMwMCkpLFxyXG4gIG5ldyBPYnN0YWNsZSgxMDAsIDMwMCwgMjAsIDE1MCwgbmV3IEhlYWx0aCgzMDApKSxcclxuICBuZXcgT2JzdGFjbGUoNjAwLCA0MDAsIDkwLCA3MCwgbmV3IEhlYWx0aCgzMDApKSxcclxuXTtcclxuXHJcbmNvbnN0IHdvcmxkID0gbmV3IFdvcmxkKDcwMCwgNTAwKTtcclxuXHJcbmV4cG9ydCBjb25zdCBkZWZhdWx0Q29uZmlnID0ge1xyXG4gIHBsYXllcnMsXHJcbiAgb2JzdGFjbGVzLFxyXG4gIHdvcmxkLFxyXG59O1xyXG4iLCJpbXBvcnQgeyBDb250cm9scyB9IGZyb20gXCIuLi9jb21wb25lbnRzL2NvbnRyb2xzXCI7XHJcbmltcG9ydCB7IEhlYWx0aCB9IGZyb20gXCIuLi9jb21wb25lbnRzL2hlYWx0aFwiO1xyXG5pbXBvcnQgeyBQbGF5ZXIgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9wbGF5ZXJcIjtcclxuaW1wb3J0IHsgU2hvb3RlciB9IGZyb20gXCIuLi9jb21wb25lbnRzL3Nob290ZXJcIjtcclxuaW1wb3J0IHsgUGxheWVyRGV0YWlscyB9IGZyb20gXCIuLi9pbnRlcmZhY2VzL3BsYXllckRldGFpbHNcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBIdW1hblBsYXllciBleHRlbmRzIFBsYXllciB7XHJcbiAgY29uc3RydWN0b3IoXHJcbiAgICBwdWJsaWMgZGV0YWlsczogUGxheWVyRGV0YWlscyxcclxuICAgIHg6IG51bWJlcixcclxuICAgIHk6IG51bWJlcixcclxuICAgIHB1YmxpYyBoZWFsdGg6IEhlYWx0aCxcclxuICAgIHB1YmxpYyBjb250cm9sczogQ29udHJvbHMsXHJcbiAgICBwdWJsaWMgc2hvb3RlcjogU2hvb3RlcixcclxuICAgIHdpZHRoOiBudW1iZXIgPSAxMDAsXHJcbiAgICBoZWlnaHQ6IG51bWJlciA9IDEwMCxcclxuICAgIGRlbHRhWDogbnVtYmVyID0gMCxcclxuICAgIGRlbHRhWTogbnVtYmVyID0gMFxyXG4gICkge1xyXG4gICAgc3VwZXIoZGV0YWlscywgeCwgeSwgaGVhbHRoLCBzaG9vdGVyLCB3aWR0aCwgaGVpZ2h0LCBkZWx0YVgsIGRlbHRhWSk7XHJcbiAgICB0aGlzLmNvbnRyb2xzLm9uSW5wdXRIYW5kbGVyID0gKGlucHV0LCBuZXdTdGF0ZSwgZXZlbnQpID0+IHtcclxuICAgICAgaWYgKFwiTE1CXCIgPT09IGlucHV0ICYmIG5ld1N0YXRlKSB7XHJcbiAgICAgICAgc3VwZXIuc2hvb3Qoe1xyXG4gICAgICAgICAgeDogKGV2ZW50IGFzIE1vdXNlRXZlbnQpLm9mZnNldFgsXHJcbiAgICAgICAgICB5OiAoZXZlbnQgYXMgTW91c2VFdmVudCkub2Zmc2V0WSxcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuICAgIHRoaXMubW92ZW1lbnRBbW91bnQgPSA1O1xyXG4gIH1cclxuXHJcbiAgbW92ZSgpOiB2b2lkIHtcclxuICAgIGlmICh0aGlzLmNvbnRyb2xzLmlucHV0cy5LZXlXKSB7XHJcbiAgICAgIHRoaXMuZGVsdGFZID0gLXRoaXMubW92ZW1lbnRBbW91bnQ7XHJcbiAgICB9IGVsc2UgaWYgKHRoaXMuY29udHJvbHMuaW5wdXRzLktleVMpIHtcclxuICAgICAgdGhpcy5kZWx0YVkgPSB0aGlzLm1vdmVtZW50QW1vdW50O1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5kZWx0YVkgPSAwO1xyXG4gICAgfVxyXG5cclxuICAgIGlmICh0aGlzLmNvbnRyb2xzLmlucHV0cy5LZXlBKSB7XHJcbiAgICAgIHRoaXMuZGVsdGFYID0gLXRoaXMubW92ZW1lbnRBbW91bnQ7XHJcbiAgICB9IGVsc2UgaWYgKHRoaXMuY29udHJvbHMuaW5wdXRzLktleUQpIHtcclxuICAgICAgdGhpcy5kZWx0YVggPSB0aGlzLm1vdmVtZW50QW1vdW50O1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgdGhpcy5kZWx0YVggPSAwO1xyXG4gICAgfVxyXG4gICAgc3VwZXIubW92ZSgpO1xyXG4gIH1cclxufVxyXG4iLCJpbnRlcmZhY2UgQ29udHJvbE1hcCB7XHJcbiAgW2NvbnRyb2w6IHN0cmluZ106IGJvb2xlYW47XHJcbn1cclxuXHJcbnR5cGUgaW5wdXRIYW5kbGVyID0gKFxyXG4gIGlucHV0OiBzdHJpbmcsXHJcbiAgbmV3U3RhdGU6IGJvb2xlYW4sXHJcbiAgZTogTW91c2VFdmVudCB8IEtleWJvYXJkRXZlbnRcclxuKSA9PiB2b2lkO1xyXG5cclxuZXhwb3J0IGNsYXNzIENvbnRyb2xzIHtcclxuICBpbnB1dHM6IENvbnRyb2xNYXA7XHJcbiAgI29uSW5wdXQ6IGlucHV0SGFuZGxlcjtcclxuXHJcbiAgY29uc3RydWN0b3IoY2FudmFzOiBIVE1MQ2FudmFzRWxlbWVudCwgd2luZG93OiBXaW5kb3cpIHtcclxuICAgIC8vIE1pZ2h0IGJlIHdvcnRoIHNldHRpbmcgdGhpcyBvYmplY3QgdXAgYXMgYSBwcm94eT9cclxuICAgIHRoaXMuaW5wdXRzID0ge1xyXG4gICAgICBLZXlXOiBmYWxzZSxcclxuICAgICAgS2V5QTogZmFsc2UsXHJcbiAgICAgIEtleVM6IGZhbHNlLFxyXG4gICAgICBLZXlEOiBmYWxzZSxcclxuICAgICAgTE1COiBmYWxzZSxcclxuICAgIH07XHJcbiAgICB0aGlzLiNvbklucHV0ID0gKGlucHV0LCBuZXdWYWx1ZSkgPT4gY29uc29sZS5sb2coeyBpbnB1dCwgbmV3VmFsdWUgfSk7XHJcblxyXG4gICAgY29uc3QgY2xpY2tMaXN0ZW5lciA9IChlOiBNb3VzZUV2ZW50KSA9PiB7XHJcbiAgICAgIGlmICgwID09PSBlLmJ1dHRvbikge1xyXG4gICAgICAgIHRoaXMuaW5wdXRzLkxNQiA9IGUudHlwZSA9PT0gXCJtb3VzZWRvd25cIjtcclxuICAgICAgICB0aGlzLiNvbklucHV0KFwiTE1CXCIsIHRoaXMuaW5wdXRzLkxNQiwgZSk7XHJcbiAgICAgIH1cclxuICAgIH07XHJcblxyXG4gICAgY29uc3Qga2V5TGlzdGVuZXIgPSAoZTogS2V5Ym9hcmRFdmVudCkgPT4ge1xyXG4gICAgICBjb25zdCB7IGNvZGUgfSA9IGU7XHJcbiAgICAgIGlmICh0aGlzLmlucHV0cy5oYXNPd25Qcm9wZXJ0eShjb2RlKSkge1xyXG4gICAgICAgIHRoaXMuaW5wdXRzW2NvZGVdID0gZS50eXBlID09PSBcImtleWRvd25cIjtcclxuICAgICAgICB0aGlzLiNvbklucHV0KGNvZGUsIHRoaXMuaW5wdXRzW2NvZGVdLCBlKTtcclxuICAgICAgfVxyXG4gICAgfTtcclxuXHJcbiAgICBjYW52YXMuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNldXBcIiwgY2xpY2tMaXN0ZW5lcik7XHJcbiAgICBjYW52YXMuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCBjbGlja0xpc3RlbmVyKTtcclxuICAgIHdpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwia2V5dXBcIiwga2V5TGlzdGVuZXIpO1xyXG4gICAgd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIGtleUxpc3RlbmVyKTtcclxuICB9XHJcblxyXG4gIHNldCBvbklucHV0SGFuZGxlcihuZXdIYW5kbGVyOiBpbnB1dEhhbmRsZXIpIHtcclxuICAgIHRoaXMuI29uSW5wdXQgPSBuZXdIYW5kbGVyO1xyXG4gIH1cclxufVxyXG4iLCJpbXBvcnQgeyBTaGFwZSB9IGZyb20gXCIuLi9jb21wb25lbnRzL3NoYXBlXCI7XHJcblxyXG5leHBvcnQgY2xhc3MgV29ybGQgZXh0ZW5kcyBTaGFwZSB7XHJcbiAgY29uc3RydWN0b3Iod2lkdGg6IG51bWJlciwgaGVpZ2h0OiBudW1iZXIpIHtcclxuICAgIHN1cGVyKDAsIDAsIHdpZHRoLCBoZWlnaHQpO1xyXG4gIH1cclxuXHJcbiAgZHJhdygpOiB2b2lkIHt9XHJcbn1cclxuIiwiaW1wb3J0IHsgZGVmYXVsdENvbmZpZyB9IGZyb20gXCIuL2RlZmF1bHRHYW1lXCI7XHJcbmltcG9ydCB7IEdhbWUgfSBmcm9tIFwiLi9tb2RlbC9jbGFzc2VzL2dhbWVcIjtcclxuXHJcbmNvbnN0IHsgd29ybGQsIHBsYXllcnMsIG9ic3RhY2xlcyB9ID0gZGVmYXVsdENvbmZpZztcclxuY29uc3QgY2FudmFzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImNhbnZhc1wiKSE7XHJcblxyXG5jb25zdCBnYW1lID0gbmV3IEdhbWUod29ybGQsIHBsYXllcnMsIG9ic3RhY2xlcywgY2FudmFzKTtcclxuZ2FtZS5wbGF5KCk7XHJcblxyXG4vLyBPYmplY3QuYXNzaWduKHdpbmRvdywgeyBnYW1lIH0pO1xyXG4iLCJpbXBvcnQgeyBQbGF5ZXIgfSBmcm9tIFwiLi4vY29tcG9uZW50cy9wbGF5ZXJcIjtcclxuaW1wb3J0IHsgQ29tcHV0ZXJQbGF5ZXIgfSBmcm9tIFwiLi9jb21wdXRlclBsYXllclwiO1xyXG5pbXBvcnQgeyBPYnN0YWNsZSB9IGZyb20gXCIuL29ic3RhY2xlXCI7XHJcbmltcG9ydCB7IFdvcmxkIH0gZnJvbSBcIi4vd29ybGRcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBHYW1lIHtcclxuICAjY3R4OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQ7XHJcblxyXG4gIGNvbnN0cnVjdG9yKFxyXG4gICAgcHJpdmF0ZSB3b3JsZDogV29ybGQsXHJcbiAgICBwcml2YXRlIHBsYXllcnM6IFBsYXllcltdLFxyXG4gICAgcHJpdmF0ZSBvYnN0YWNsZXM6IE9ic3RhY2xlW10sXHJcbiAgICBwcml2YXRlIGNhbnZhczogSFRNTENhbnZhc0VsZW1lbnRcclxuICApIHtcclxuICAgIHRoaXMuY2FudmFzLmhlaWdodCA9IHRoaXMud29ybGQuaGVpZ2h0O1xyXG4gICAgdGhpcy5jYW52YXMud2lkdGggPSB0aGlzLndvcmxkLndpZHRoO1xyXG4gICAgdGhpcy4jY3R4ID0gdGhpcy5jYW52YXMuZ2V0Q29udGV4dChcIjJkXCIpITtcclxuICB9XHJcblxyXG4gIGdldCBjb21wdXRlclBsYXllcnMoKTogQ29tcHV0ZXJQbGF5ZXJbXSB7XHJcbiAgICByZXR1cm4gdGhpcy5wbGF5ZXJzLmZpbHRlcihcclxuICAgICAgKHBsYXllcikgPT4gcGxheWVyIGluc3RhbmNlb2YgQ29tcHV0ZXJQbGF5ZXJcclxuICAgICkgYXMgQ29tcHV0ZXJQbGF5ZXJbXTtcclxuICB9XHJcblxyXG4gIG90aGVyUGxheWVycyhwbGF5ZXJUb0V4Y2x1ZGU6IFBsYXllcik6IFBsYXllcltdIHtcclxuICAgIHJldHVybiB0aGlzLnBsYXllcnMuZmlsdGVyKChwbGF5ZXIpID0+IHBsYXllciAhPT0gcGxheWVyVG9FeGNsdWRlKTtcclxuICB9XHJcblxyXG4gIHVwZGF0ZVBvc2l0aW9ucygpOiB2b2lkIHtcclxuICAgIGZvciAoY29uc3QgY29tcHV0ZXJQbGF5ZXIgb2YgdGhpcy5jb21wdXRlclBsYXllcnMpIHtcclxuICAgICAgY29uc3QgcGxheWVyVG9TaG9vdCA9IHRoaXMucGxheWVycy5maW5kKFxyXG4gICAgICAgIChwbGF5ZXIpID0+IHBsYXllciAhPT0gY29tcHV0ZXJQbGF5ZXJcclxuICAgICAgKSE7XHJcbiAgICAgIGNvbXB1dGVyUGxheWVyLnNob290KHtcclxuICAgICAgICB4OiBwbGF5ZXJUb1Nob290LmNlbnRlci54LFxyXG4gICAgICAgIHk6IHBsYXllclRvU2hvb3QuY2VudGVyLnksXHJcbiAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMucGxheWVycyA9IHRoaXMucGxheWVycy5maWx0ZXIoKHBsYXllcikgPT4gIXBsYXllci5oZWFsdGguaXNFbXB0eSk7XHJcblxyXG4gICAgZm9yIChjb25zdCBwbGF5ZXIgb2YgdGhpcy5wbGF5ZXJzKSB7XHJcbiAgICAgIHBsYXllci5tb3ZlKCk7XHJcblxyXG4gICAgICAvLyBUT0RPOiB0aGlzIGlzIHF1YWRyYXRpYyBiZWhhdmlvdXIgKGFuZCB3aWxsIHNjYWxlIHBvb3JseSksIGJ1dCBtaWdodCBub3QgaGF2ZSBlbm91Z2hcclxuICAgICAgLy8gb2JqZWN0cy9jb21wYXJpc29ucyB0byB3YXJyYW50IGEgbW9yZSBlZmZpY2llbnQgc3RydWN0dXJlXHJcbiAgICAgIC8vIGUuZyBxdWFkdHJlZSwgb2N0b3RyZWUuXHJcbiAgICAgIGlmIChcclxuICAgICAgICBwbGF5ZXIuZXh0ZW5kc0JleW9uZCh0aGlzLndvcmxkKSB8fFxyXG4gICAgICAgIHBsYXllci5jb2xsaWRlc1dpdGhBbnkoLi4udGhpcy5vdGhlclBsYXllcnMocGxheWVyKSkgfHxcclxuICAgICAgICBwbGF5ZXIuY29sbGlkZXNXaXRoQW55KC4uLnRoaXMub2JzdGFjbGVzKVxyXG4gICAgICApIHtcclxuICAgICAgICBwbGF5ZXIubW92ZUJhY2soKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgZm9yIChjb25zdCBzaG90IG9mIHBsYXllci5zaG9vdGVyLnNob3RzRmlyZWQpIHtcclxuICAgICAgICBzaG90Lm1vdmUoKTtcclxuICAgICAgfVxyXG5cclxuICAgICAgdGhpcy5wcm9jZXNzQ29sbGlzaW9ucygpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgcHJvY2Vzc0NvbGxpc2lvbnMoKTogdm9pZCB7XHJcbiAgICBmb3IgKGNvbnN0IHBsYXllciBvZiB0aGlzLnBsYXllcnMpIHtcclxuICAgICAgcGxheWVyLnNob290ZXIua2VlcFNob3RzV2hlcmUoKHNob3QpID0+IHtcclxuICAgICAgICAvLyBEb2VzIHNob3QgY29sbGlkZSB3aXRoIGFueSBvYnN0YWNsZXM/XHJcbiAgICAgICAgY29uc3Qgb2JzdGFjbGVzU2hvdCA9IHNob3QuZ2V0QWxsQ29sbGlzaW9uc1dpdGgoLi4udGhpcy5vYnN0YWNsZXMpO1xyXG4gICAgICAgIG9ic3RhY2xlc1Nob3QuZm9yRWFjaCgob2JzdGFjbGUpID0+XHJcbiAgICAgICAgICBvYnN0YWNsZS5oZWFsdGguY2hhbmdlSGVhbHRoQnkoLXNob3QuZGFtYWdlKVxyXG4gICAgICAgICk7XHJcblxyXG4gICAgICAgIC8vIERvZXMgc2hvdCBjb2xsaWRlIHdpdGggYW55IHBsYXllcnM/XHJcbiAgICAgICAgY29uc3QgcGxheWVyc1Nob3QgPSBzaG90LmdldEFsbENvbGxpc2lvbnNXaXRoKFxyXG4gICAgICAgICAgLi4udGhpcy5vdGhlclBsYXllcnMocGxheWVyKVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgcGxheWVyc1Nob3QuZm9yRWFjaCgocGxheWVyKSA9PlxyXG4gICAgICAgICAgcGxheWVyLmhlYWx0aC5jaGFuZ2VIZWFsdGhCeSgtc2hvdC5kYW1hZ2UpXHJcbiAgICAgICAgKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIChcclxuICAgICAgICAgIG9ic3RhY2xlc1Nob3QubGVuZ3RoID09PSAwICYmXHJcbiAgICAgICAgICBwbGF5ZXJzU2hvdC5sZW5ndGggPT09IDAgJiZcclxuICAgICAgICAgIC8vIEhhcyBzaG90IGxlZnQgdGhlIHdvcmxkL3ZpZXcgc2NvcGU/XHJcbiAgICAgICAgICAhc2hvdC5leHRlbmRzQmV5b25kKHRoaXMud29ybGQpXHJcbiAgICAgICAgKTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgdGhpcy5vYnN0YWNsZXMgPSB0aGlzLm9ic3RhY2xlcy5maWx0ZXIoXHJcbiAgICAgIChvYnN0YWNsZSkgPT4gIW9ic3RhY2xlLmhlYWx0aC5pc0VtcHR5XHJcbiAgICApO1xyXG4gIH1cclxuXHJcbiAgZHJhdygpOiB2b2lkIHtcclxuICAgIHRoaXMuI2N0eC5jbGVhclJlY3QoMCwgMCwgdGhpcy5jYW52YXMud2lkdGgsIHRoaXMuY2FudmFzLmhlaWdodCk7XHJcbiAgICBmb3IgKGNvbnN0IHBsYXllciBvZiB0aGlzLnBsYXllcnMpIHtcclxuICAgICAgcGxheWVyLmRyYXcodGhpcy4jY3R4KTtcclxuXHJcbiAgICAgIGZvciAoY29uc3Qgc2hvdCBvZiBwbGF5ZXIuc2hvb3Rlci5zaG90c0ZpcmVkKSB7XHJcbiAgICAgICAgc2hvdC5kcmF3KHRoaXMuI2N0eCk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGZvciAoY29uc3Qgb2JzdGFjbGUgb2YgdGhpcy5vYnN0YWNsZXMpIHtcclxuICAgICAgICBvYnN0YWNsZS5kcmF3KHRoaXMuI2N0eCk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuICB9XHJcblxyXG4gIGdldFdpbm5lck9yTnVsbCgpOiBQbGF5ZXIgfCBudWxsIHtcclxuICAgIGNvbnN0IHJlbWFpbmluZ1BsYXllcnMgPSB0aGlzLnBsYXllcnMuZmlsdGVyKFxyXG4gICAgICAocGxheWVyKSA9PiAhcGxheWVyLmhlYWx0aC5pc0VtcHR5XHJcbiAgICApO1xyXG5cclxuICAgIHJldHVybiByZW1haW5pbmdQbGF5ZXJzLmxlbmd0aCA9PT0gMSA/IHJlbWFpbmluZ1BsYXllcnNbMF0gOiBudWxsO1xyXG4gIH1cclxuXHJcbiAgcGxheSgpOiB2b2lkIHtcclxuICAgIHRoaXMudXBkYXRlUG9zaXRpb25zKCk7XHJcbiAgICB0aGlzLmRyYXcoKTtcclxuICAgIGNvbnN0IHdpbm5lck9yTnVsbCA9IHRoaXMuZ2V0V2lubmVyT3JOdWxsKCk7XHJcbiAgICBpZiAod2lubmVyT3JOdWxsKSB7XHJcbiAgICAgIHNldFRpbWVvdXQoKCkgPT4gYWxlcnQoYCR7d2lubmVyT3JOdWxsLmRldGFpbHMubmFtZX0gd29uIWApLCAxMCk7XHJcbiAgICAgIHJldHVybjtcclxuICAgIH1cclxuXHJcbiAgICByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5wbGF5LmJpbmQodGhpcykpO1xyXG4gIH1cclxufVxyXG4iXSwic291cmNlUm9vdCI6IiJ9